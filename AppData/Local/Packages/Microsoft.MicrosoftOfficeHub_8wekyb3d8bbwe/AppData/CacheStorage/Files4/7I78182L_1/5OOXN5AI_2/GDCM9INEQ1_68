(window.officehome_pwa_webpackJsonp=window.officehome_pwa_webpackJsonp||[]).push([[148],{r8hs:function(e,i,t){"use strict";t.r(i);var r=t("mXGw"),n=t("xARA"),s=t("70cc"),a=t("WKA6"),o=t("BaAg"),c=r?class extends r.Component{render(){return"Start"!==this.props.route||this.props.app!==o.b.Word&&this.props.app!==o.b.Excel&&this.props.app!==o.b.PowerPoint?null:(this.props.instrumentationService.logImpressionEvent("Upsell_Button_Impression"),r.createElement("a",{id:"upsell-button",style:{lineHeight:"normal"},className:"shell-upsell-button o365sx-button o365sx-highContrastButton",href:this.getUrl(),target:this.props.linkTarget,"aria-label":this.props.locService.FirstRunFreeConsumerGoPremium},r.createElement("span",{className:"shell-upsell-button__icon ms-ohp-Icon ms-ohp-Icon--diamond"}),r.createElement("span",{className:"shell-upsell-button__text"},this.props.locService.FirstRunFreeConsumerGoPremium)))}getUrl(){return`https://products.office.com/compare-all-microsoft-office-products?&ocid=PROD_OfficeCom-${this.props.upsellDataService.getUpsellTrackingParam()}_${o.b[this.props.app]}StartHeader_Unknown_GoPremium`}}:()=>null,l=t("vSs+"),m=t("hhzZ"),h=t("6nG3"),u=t("PBJH");t.d(i,"UpsellButton",function(){return p});class p{constructor(e,i,t,r,n){this.consumerInstallConfigService=e,this.contextService=i,this.eventService=t,this.injector=r,this.officeRouteService=n,this.consumerInstallConfigService.getConfig().then(e=>{const i=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:h.b.NotDetected;i!==h.b.NotSubscribed&&i!==h.b.NonActive||this.subscribe()})}unsubscribe(){this.routeChangeEndSubscription&&this.routeChangeEndSubscription.unsubscribe()}subscribe(){this.eventService.events.withScope(0).pipe(Object(s.a)(e=>"renderUpsellButton"===e.name),Object(a.a)(1)).toPromise().then(e=>{if(e.args.length){const i=e.args[0];this.routeChangeEndSubscription=this.officeRouteService.subscribeToRouteChangeEnd(e=>{r&&n.render(r.createElement(c,{route:e.currentRoute.route,app:e.currentRoute.app,locService:this.injector.get(u.a),instrumentationService:this.injector.get(m.a),upsellDataService:this.injector.get(l.a),linkTarget:this.contextService.sharedContext.defaultLinkTarget}),i)})}})}}},"vSs+":function(e,i,t){"use strict";t.d(i,"a",function(){return D});var r=t("70cc"),n=t("WKA6"),s=t("lrJm"),a=t("y3b+"),o=t("hhzZ"),c=t("hZW2"),l=t("7Gwk"),m=t("Uqr9"),h=t("casz"),u=t("TIi1"),p=t("4/We"),d=t("cgnd"),f=t("/I02"),g=t("pjz5"),S=t("Mlb/"),v=t("Qo/9");class D{constructor(e,i,t,r,n,s,a,o,c,l,m,h){this.cookieService=e,this.eventService=i,this.capabilitiesService=t,this.clientStartupConfigService=r,this.contextService=n,this.documentService=s,this.globalErrorHandler=a,this.installConfigService=o,this.instrumentationService=c,this.performanceService=l,this.schedulerService=m,this.urlLauncherService=h,this.upsellTrackingParam="",this.dimeDisabled=!1}getUpsellTrackingParam(){if(this.capabilitiesService.capabilities.isPwaInUwp){if(""===this.upsellTrackingParam){if(this.upsellTrackingParam="PWA",MyOffice.RuntimeComponents&&MyOffice.RuntimeComponents.ClientSystem)try{const e=MyOffice.RuntimeComponents.ClientSystem.getDeviceOEMIdentifier();this.upsellTrackingParam=`PWA-${e}`}catch(e){this.globalErrorHandler.handleError(e,"t90JZ")}const e="launchByWordPad";("wordpad"===this.clientStartupConfigService.config.sharedClientStartupContext.requestOrigin.toLowerCase()||this.cookieService.get(e))&&(this.upsellTrackingParam+="-WordPad")}}else this.upsellTrackingParam="HomePage";return this.upsellTrackingParam}broadcastUpsell(){this.eventService.broadcastEvent({name:"premiumTemplatesUpsellStarted",args:[]})}warmupDime(){return this.warmupDimePromise?this.warmupDimePromise:(this.logDimeEvent("Dime_Warmup"),this.warmupDimePromise=new Promise(e=>{this.eventService.events.withScope(0).pipe(Object(r.a)(e=>"mruFailed"===e.name||"mruReady"===e.name),Object(n.a)(1)).toPromise().then(()=>{this.schedulerService.scheduleWork(()=>{this.loadDime().then(e=>{1===e&&this.preloadDimeExperience()})},4),e()})}),this.warmupDimePromise)}launchDime(e,i){if(this.dimeDisabled)return this.urlLauncherService.openUrl(i,"Upsell"),void this.logDimeEvent("Dime_Launch",e,"Failed","RedirectToPOC;DimeDisabled");let t=null;const r=this.loadDime(),n=new Promise(e=>{t=setTimeout(()=>{e(0)},this.installConfigService.config.dimeTimeoutMs)});return Promise.race([r,n]).then(r=>{if(t&&clearTimeout(t),1!==r)return this.dimeDisabled=!0,void this.logDimeEvent("Dime_Launch",e,"Failed","TimeOut");try{const t=this.getCampainIdFromTargetUrl(i),r={experience:e,campaignId:t};this.logDimeEvent("Dime_Launch",e,"Start"),this.dime.launch(r,()=>{this.logDimeEvent("Dime_Impression",e)}).then(i=>{this.logDimeEvent("Dime_Completed",e,i.status,i.metaData)})}catch(t){this.dimeDisabled=!0,this.logDimeEvent("Dime_Launch",e,"Failed",t,"RedirectToPOC;LaunchException"),this.urlLauncherService.openUrl(i,"Upsell")}})}loadDime(){return this.loadDimePromise?this.loadDimePromise:(this.performanceService.mark("LoadDimeScript_Started"),this.loadDimePromise=new Promise(e=>{this.documentService.addScriptToPage(this.installConfigService.config.dimeJSUrl,()=>{this.logDimeEvent("Dime_LoadScript","","Succeeded"),this.performanceService.mark("LoadDimeScript_Completed"),this.initializeDime().then(()=>{e(1)}).catch(()=>{e(2)})},()=>{this.logDimeEvent("Dime_LoadScript","","Failed"),e(2)},!1,"dimeScript")}),this.loadDimePromise)}getCampainIdFromTargetUrl(e){if(e&&e.indexOf("ocid=")>0){const i=g.a.getLocation(e),t=g.a.getQueryParams(i.search);return""!==t.ocid?t.ocid:"PROD_OfficeCom"}return"PROD_OfficeCom"}initializeDime(){return new Promise((e,i)=>{if(this.dime&&e(1),this.dimeDisabled&&e(2),"undefined"!=typeof Dime){this.performanceService.mark("DimeInitialize_Start");const t={partnerId:this.capabilitiesService.capabilities.pwaEnabled?"officepwa":"officedotcom",language:this.contextService.sharedContext.officeMarket,sessionId:this.clientStartupConfigService.config.sharedClientStartupContext.sessionId,authHint:this.capabilitiesService.capabilities.pwaEnabled?this.clientStartupConfigService.config.puid:this.clientStartupConfigService.config.userPrincipalName};try{this.dime=new Dime(t),this.performanceService.mark("DimeInitialize_Complete"),this.logDimeEvent("Dime_Initialize","","Succeeded"),e(1)}catch(e){this.dimeDisabled=!0,this.logDimeEvent("Dime_Initialize","","Failed",e),i()}}else this.dimeDisabled=!0,this.logDimeEvent("Dime_Initialize","","Failed","Dime_Undefined"),i()})}preloadDimeExperience(){this.dime&&(this.performanceService.mark("DimePreload_Start"),this.logDimeEvent("Dime_Preload","","Start"),this.dime.preload({experiences:["installbutton","buybutton"]}).catch(e=>this.logDimeEvent("Dime_Preload","","Failed",e)))}logDimeEvent(e,i="",t="",r,n){const s={};s.DimeExperience=i,s.State=t;const a=n?n+";":"";s.DebugInfo="string"==typeof r?a+r:r?a+JSON.stringify(r):a,this.instrumentationService.logGenericEvent(e,s)}}D.ngInjectableDef=S.R({factory:function(){return new D(S.V(v.d),S.V(l.a),S.V(p.a),S.V(d.b),S.V(f.a),S.V(c.a),S.V(s.b),S.V(a.a),S.V(o.a),S.V(m.b),S.V(h.a),S.V(u.a))},token:D,providedIn:"root"})},"y3b+":function(e,i,t){"use strict";t.d(i,"a",function(){return s});var r=t("dFxn"),n=t("Mlb/");class s{constructor(e){this.config=e.parse("installConfig")||{consumerDirectInstallUrl:"",consumerInstallLink:"",commercialMySoftwarePageUrl:"",dimeEnabled:!1,dimeJSUrl:"",dimeTimeoutMs:5e3,goPremiumUrl:"",installApiRoot:"",installApiSWEnabled:!1,resources:null,sendRequestId:!1,wizardImageAssets:"",wizardSupportLink:"",buyOffice365Url:"",haveOfficeProductKeyUrl:"",needHelpInstallingOfficeUrl:""}}}s.ngInjectableDef=n.R({factory:function(){return new s(n.V(r.a))},token:s,providedIn:"root"})}}]);
//# sourceMappingURL=pwa-148.1981d874cfdc630d0e94.chunk.v2.js.map