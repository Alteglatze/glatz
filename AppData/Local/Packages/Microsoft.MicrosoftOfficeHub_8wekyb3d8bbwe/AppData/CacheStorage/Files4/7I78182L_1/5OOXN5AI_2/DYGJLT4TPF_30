(window.officehome_pwa_webpackJsonp=window.officehome_pwa_webpackJsonp||[]).push([[20],{"3OD8":function(e,t,n){},AzcM:function(e,t,n){"use strict";n.r(t);var i=n("Mlb/"),l=n("qIlG"),s=n("QhWD"),r=n("hhzZ"),a=n("Vwd8"),o=n("6nG3"),u=n("W3Zz"),c=n("hZW2"),h=n("7Gwk"),d=n("Uqr9"),m=n("TIi1"),p=n("4/We"),g=n("cgnd"),f=n("LQqy"),b=n("/I02"),v=n("PBJH"),S=n("dFxn");class C{constructor(e){this.config=e.parse("startpageDeprecationConfig")||{text:null,image:null}}}C.ngInjectableDef=i.R({factory:function(){return new C(i.V(S.a))},token:C,providedIn:"root"});var w=n("c8Ce"),k=n("vSs+"),y=n("sH0/"),E=n("gktR"),D=n("b7yv"),I=n("CVeG");class R{transform(e,t,n=!0){return e?((e.includes("<br/>")||e.includes("<br>"))&&(n=!1),t?this.textToHtml(e,n):e.replace(/<c0>|<\/c0>|<b0>|<\/b0>/g,"")):e}textToHtml(e,t){const n=!e.includes("<c0>");return this.boldAndColoredText(e,n,t)}boldAndColoredText(e,t,n){let i="",l=e.split(t?/<b0>(.*?)<\/b0>/:/<c0>(.*?)<\/c0>/);if(l=l.map(e=>e.split("&nbsp;").map(I.a.escapeHtml).join("&nbsp;")),n){const e=l.map(e=>e.replace("&nbsp;"," ")).join("").length;if(e<45){const t=e/2;let n=0,i=!1;l=l.map(e=>{let l=e.split(" ");return(l=l.map((e,l)=>i?l?` ${e}`:e:(n+=e.replace("&nbsp;"," ").length+(l?1:0))-t>e.length/2?(i=!0,`<br><span class="space-holder">&nbsp;</span>${e}`):l?` ${e}`:e)).join("")})}}else l=l.map(e=>e.replace(/&lt;br\/&gt;(.*)/g,"<div>$1</div>"));const s=t?"call-out--not-bold":"call-out";for(let e=0;e<l.length;e++)i+=e%2==0?`<span class="${s}">${l[e]}</span>`:`${l[e]}`;return t&&(i=`<span class="call-out">${i}</span>`),i}}n("3OD8");class x{constructor(e,t,n,i,l,s,r,a,o,c,h,d,m,p,g,f,b,v,S,C,w,k,y){this.capabilitiesService=e,this.contextService=t,this.documentService=i,this.domSanitizer=l,this.eventService=s,this.firstRunCalloutsConfigService=r,this.firstRunConfigService=a,this.firstRunDataService=o,this.firstRunTextPipe=c,this.instrumentationService=h,this.lazyViewLoaderService=d,this.locService=m,this.performanceService=p,this.renderer=g,this.urlLauncherService=f,this.startupConfigService=b,this.consumerInstallConfigService=v,this.startpageDeprecationConfigService=S,this.upsellConfigService=C,this.upsellDataService=w,this.userProfileService=k,this.viewRef=y,this.visible=!1,this.complete=!1,this.currentSlide=0,this.leftArrowHasFocus=!1;const E=n.deviceInfo.browser.browserType;this.shouldUseCssAnimation=!(E===u.a.IE||E===u.a.Edge),this.shouldUseHighOpacity=E===u.a.IE,this.announcementEnabled=!1,this.firstRunVersion=this.firstRunCalloutsConfigService.config.version,this.modalType="first-run",this.isUpsell=!1}ngOnInit(){this.componentArea=r.b.FirstRun,this.isRtl=this.contextService.isRtl;const e=this.firstRunConfigService.getConfig().then(e=>this.firstRunConfig=e),t=this.firstRunDataService.fetchFirstRunData(this.firstRunVersion,!0,E.a.firstRunDataKey);Promise.all([t,e]).then(([e,t])=>{if(!this.firstRunConfig||!this.firstRunConfig.alwaysShowInTestMode&&(e.CompletedFirstRun||e.Version<this.firstRunVersion))return!1;const n=this.firstRunConfig.model;return!!(n&&n.slides&&n.slides.length)&&(this.getResources(),this.firstRunType=n.firstRunType,this.isCapturingIntent=this.capabilitiesService.capabilities.capturingIntentEnabled&&("FreeConsumer"===this.firstRunType||"EduStudent"===this.firstRunType),this.firstRunType===x.consumerSkuNotDetectedPwa?this.consumerInstallConfigService.getConfig().then(e=>{const t=e.currentSkuInfo.skuType;t===o.b.NonActive||t===o.b.NotSubscribed?(this.firstRunType="FreeConsumerPwa",this.initModel(n.slides[0]),this.finishInit()):t!==o.b.NotDetected&&(this.firstRunType="PaidConsumerPwa",this.initModel(n.slides[1]),this.finishInit())}):(this.initModel(n.slides[0]),this.finishInit()),!0)}).then(e=>{if(!e&&this.capabilitiesService.capabilities.showStartPageDeprecationModal)return this.userProfileService.doesMetricExist("CustomStart_Deprecation_Modal_Impression",!0).then(e=>{if(e)return!1;{const e=this.startpageDeprecationConfigService.config,t=new Array;return t.push({text:e.text,image:e.image}),this.modalType="startpage-deprecation",this.initModel(t),this.finishInit(),!0}})}),this.upsellConfigService.getConfig().then(t=>{if(t){this.upsellConfig=t;const n=t.model;Promise.all([e,this.eventService.whenEventFired("premiumTemplatesUpsellStarted",0)]).then(()=>{n&&(this.modalType="premium-upsell",this.initUpsell(n))})}})}ngAfterViewInit(){this.slideElements.changes.pipe(Object(l.a)()).toPromise().then(()=>{if(this.focusRightArrowButton(),this.setSlideAnnouncement(this.nextButtonAriaLabel),this.announcementEnabled=!0,this.isCapturingIntent){const e="EduStudent"===this.firstRunType;this.createCreateButtonElement(e).then(t=>(this.documentService.nativeDocument.getElementById("customized-template__create-button-1").appendChild(t),e?this.createCreateButtonElement(!1):null)).then(e=>{if(e){const t=this.documentService.nativeDocument.getElementById("customized-template__create-button-2");t&&t.appendChild(e)}})}})}getPaginationAriaLabel(){return this.locService.format(this.paginationAriaLabel,(this.currentSlide+1).toString(),this.slides.length.toString())}nextSlide(){const e=this.currentSlide+1;e>=this.slides.length?this.dismiss():(this.changeSlide(e),this.setSlideAnnouncement(e===this.slides.length-1?this.completeButtonAriaLabel:this.nextButtonAriaLabel))}previousSlide(){this.changeSlide(this.currentSlide-1),0===this.currentSlide&&this.leftArrowHasFocus&&this.focusRightArrowButton(),this.setSlideAnnouncement(0===this.currentSlide?"":this.backButtonAriaLabel)}dismiss(){this.complete=!0,"premium-upsell"===this.modalType?this.instrumentationService.logGenericEvent("Upsell_Dialog_Close"):(this.instrumentSlideStats("dismiss"),this.instrumentFirstRunCompletion());const e=()=>{this.visible=!1,this.eventService.broadcastEvent({name:"firstRunModalClosed",args:[]}),this.transitionEndListeners&&this.transitionEndListeners.forEach(e=>e())};this.transitionEndListeners=x.transitionEndEvents.map(t=>this.renderer.listen(this.welcomeOverlay.nativeElement,t,e)),this.isUpsell&&this.eventService.broadcastEvent({name:"premiumTemplatesUpsellClosed",args:[]})}focusLeftArrow(){this.leftArrowHasFocus=!0}blurLeftArrow(){this.leftArrowHasFocus=!1}trackByIndex(e){return e}freButtonOnClick(e){e?this.isUpsell?(this.urlLauncherService.openUrl(e,"Upsell"),this.instrumentationService.logClickEvent("Upsell_Button_Click","upsell-go-premium-button",r.b.Upsell),this.dismiss()):this.urlLauncherService.openUrl(e,"FREAction"):this.dismiss()}createCreateButtonElement(e){return this.lazyViewLoaderService.loadLazyViewFromModule("create-menu#CreateMenuModule").then(t=>{const n=this.viewRef.createComponent(t);return n.instance.isInFre=!0,n.instance.buttonOrigin="capturing-intent",n.instance.createNotebookText=e,n.instance.createDocumentText=!e,n.hostView.rootNodes[0]})}finishInit(){if(this.setSlideFocusElement(),this.movePaginationDown=this.slides.some(e=>e.buttons&&e.buttons.length>0),this.visible=!0,this.eventService.broadcastEvent({name:"firstRunModalOpen",args:[]}),setTimeout(()=>this.show=!0,100),"startpage-deprecation"===this.modalType)this.instrumentationService.logImpressionEvent("CustomStart_Deprecation_Modal_Impression",{},["CustomStart_Deprecation_Modal_Impression"]);else if("premium-upsell"===this.modalType)this.instrumentationService.logImpressionEvent("Upsell_Dialog_Impression");else{this.performanceService.mark("FREv2_Ready");const e=d.a.now();this.firstRunStartTime=e,this.slideStartTime=e,this.instrumentSlideImpression(-1);const t=this.startupConfigService.config.authType===g.a.MSA;(!this.capabilitiesService.capabilities.modalFreCalloutEnabled||this.capabilitiesService.capabilities.pwaEnabled&&t)&&this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:this.slides.length,Version:this.firstRunVersion,TotalSteps:this.slides.length},E.a.firstRunDataKey)}}focusRightArrowButton(){const e=document.getElementById("first-run-arrow-rt");e&&e.focus()}setSlideFocusElement(){this.slideFocusElement=this.slides[this.currentSlide].htmlFile?"customized-card-button-0":"close-welcome-overlay"}changeSlide(e){const t=this.currentSlide;this.instrumentSlideStats(this.currentSlide>e?"back":"next"),this.currentSlide=e,this.instrumentSlideImpression(t),this.setSlideFocusElement()}setSlideAnnouncement(e){this.slideAnnouncement=`${this.nextSlideAnnouncementAriaLabel} ${this.firstRunTextPipe.transform(this.slides[this.currentSlide].text,!1)}${e?". "+e:""}`}initModel(e){this.safeHtmlSlides=new Array(e.length),e.forEach((e,t)=>{e.htmlFile&&(this.replaceStrings(e),this.replaceOEMCode(e),this.documentService.addOrUpdateStylesheet(e.styleSource,"customizedSlide")),this.safeHtmlSlides[t]=this.domSanitizer.bypassSecurityTrustHtml(e.htmlFile)}),this.slides=e}replaceStrings(e){if(e.replacementStrings){e.replacementStrings=e.replacementStrings.map(e=>e.match(/<c0>|<\/c0>|<b0>|<\/b0>/g)?this.firstRunTextPipe.transform(e,!0,!1):e);for(let t=0;t<e.replacementStrings.length;t++)e.htmlFile=e.htmlFile.replace(`STRING${t+1}`,e.replacementStrings[t])}}replaceOEMCode(e){const t=this.upsellDataService.getUpsellTrackingParam();"FreeConsumerPwa"===this.firstRunType?e.buttons&&e.buttons[0]&&e.buttons[0].link&&(e.buttons[0].link=e.buttons[0].link.replace("{OEM}",t)):e.htmlFile=e.htmlFile.replace("{OEM}",t)}instrumentSlideStats(e){const t={};t.FirstRunTotalSteps=this.slides.length.toString(),t.FirstRunVersion=this.modalType,t.FirstRunType=this.firstRunType;const n=d.a.now();t.Latency=Math.ceil(n-this.slideStartTime).toString(),this.slideStartTime=n,t.Index=this.currentSlide.toString(),t.Action=e,this.instrumentationService.logGenericEvent("First_Run_Slide_Stats",t)}instrumentFirstRunCompletion(){const e={};e.FirstRunTotalSteps=this.slides.length.toString(),e.FirstRunVersion=this.modalType,e.FirstRunType=this.firstRunType,e.FirstRunStepsCompleted=(this.currentSlide+1).toString(),e.Latency=Math.ceil(d.a.now()-this.firstRunStartTime).toString(),this.instrumentationService.logGenericEvent("First_Run_Completed",e)}instrumentSlideImpression(e){const t={};t.FirstRunTotalSteps=this.slides.length.toString(),t.FirstRunVersion=this.modalType,t.FirstRunType=this.firstRunType,t.FirstRunPreviousStep=e.toString(),t.Index=this.currentSlide.toString(),this.instrumentationService.logImpressionEvent("First_Run_Impression",t)}initUpsell(e){this.isUpsell=!0,this.complete=!1,this.componentArea=r.b.Upsell,this.getResources(),this.initModel(e[0].slides),this.finishInit()}getResources(){if(this.firstRunConfig){this.microsoftIcon=this.firstRunConfig.microsoftIconPath;const e=this.firstRunConfig.resources;this.backButtonAriaLabel=e.FirstRunBackButtonAriaLabel,this.nextButtonAriaLabel=e.FirstRunNextButtonAriaLabel,this.completeButtonAriaLabel=e.FirstRunCompleteButtonAriaLabel,this.closeButtonAriaLabel=e.FirstRunCloseButtonAriaLabel,this.nextSlideAnnouncementAriaLabel=e.FirstRunNextSlideAnnouncementAriaLabel,this.paginationAriaLabel=e.FirstRunPaginationAriaLabel,this.microsoftLogo=e.FirstRunMicrosoftLogo}this.isUpsell&&this.upsellConfig&&(this.learnMoreButtonAriaLabel=this.upsellConfig.resources.LearnMoreButtonAriaLabel,this.closeButtonAriaLabel=this.upsellConfig.resources.UpsellCloseButtonAriaLabel)}}x.transitionEndEvents=["transitionend","webkitTransitionEnd","oTransitionEnd","otransitionend","MSTransitionEnd"],x.consumerSkuNotDetectedPwa="ConsumerSkuNotDetectedPwa";const F=x;class T{}var A=n("fYis"),P=n("WJRI"),L=n("kVgv"),_=n("vk2e"),B=n("dz0V"),O=n("NdOS"),U=n("pzhl"),M=n("PkQn"),G=n("C0xW"),z=i.nb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"leftArrowInOut",definitions:[{type:1,expr:":enter",animation:[{type:6,styles:{opacity:0,transform:"translateX(20px)"},offset:null},{type:4,styles:{type:6,styles:{opacity:1,transform:"translateX(0)"},offset:null},timings:"1000ms cubic-bezier(0.770, 0.000, 0.175, 1.000)"}],options:null},{type:1,expr:":leave",animation:[{type:4,styles:{type:6,styles:{opacity:0,transform:"translateX(20px)"},offset:null},timings:"1000ms cubic-bezier(0.770, 0.000, 0.175, 1.000)"}],options:null}],options:{}}]}});function V(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,P.b,P.a)),i.ob(1,49152,null,0,L.a,[],{announcement:[0,"announcement"]},null)],function(e,t){e(t,1,0,t.component.slideAnnouncement)},null)}function N(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,2,"div",[["class","image"],["role","img"]],[[1,"aria-label",0]],null,null,null,null)),i.ob(1,278528,null,0,_.n,[i.s,i.k,i.C],{ngStyle:[0,"ngStyle"]},null),i.Cb(2,{"background-image":0})],function(e,t){var n=e(t,2,0,"url("+t.parent.context.$implicit.image+")");e(t,1,0,n)},function(e,t){e(t,0,0,t.parent.context.$implicit.altText)})}function $(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,6,"div",[["class","text-callout"]],null,null,null,null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Cb(2,{"text-callout--button":0,"slide-text__startpage-deprecation":1}),(e()(),i.pb(3,0,null,null,3,"p",[],[[8,"innerHTML",1]],null,null,null,null)),i.ob(4,278528,null,0,_.n,[i.s,i.k,i.C],{ngStyle:[0,"ngStyle"]},null),i.Cb(5,{color:0}),i.Db(6,2)],function(e,t){var n=t.component,i=e(t,2,0,n.movePaginationDown,"startpage-deprecation"===n.modalType);e(t,1,0,"text-callout",i);var l=e(t,5,0,t.parent.context.$implicit.color);e(t,4,0,l)},function(e,t){var n=i.Ib(t,3,0,e(t,6,0,i.zb(t.parent.parent.parent,0),t.parent.context.$implicit.text,!0));e(t,3,0,n)})}function H(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,2,"div",[],[[8,"innerHTML",1]],null,null,null,null)),i.ob(1,278528,null,0,_.n,[i.s,i.k,i.C],{ngStyle:[0,"ngStyle"]},null),i.Cb(2,{color:0,"font-weight":1})],function(e,t){var n=e(t,2,0,t.parent.context.$implicit.color,700);e(t,1,0,n)},function(e,t){e(t,0,0,t.component.safeHtmlSlides[t.parent.context.index])})}function J(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,2,"button",[["tabindex","1"]],[[8,"id",0],[1,"data-area",0],[1,"aria-label",0]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.freButtonOnClick(e.context.$implicit.link)&&i),i},null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{ngClass:[0,"ngClass"]},null),(e()(),i.Hb(2,null,[" "," "]))],function(e,t){e(t,1,0,"generic-button generic-button--fluent "+t.context.$implicit.buttonClass)},function(e,t){var n=t.component;e(t,0,0,t.context.$implicit.id,n.componentArea,n.isUpsell&&n.learnMoreButtonAriaLabel?n.learnMoreButtonAriaLabel:""),e(t,2,0,t.context.$implicit.text)})}function j(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,4,"div",[["class","section__buttons-container slide__buttons-container"]],null,null,null,null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Cb(2,{"slide__buttons-container--custom":0,"slide__buttons-container--custom--static-pagination":1}),(e()(),i.gb(16777216,null,null,1,null,J)),i.ob(4,278528,null,0,_.j,[i.N,i.K,i.r],{ngForOf:[0,"ngForOf"]},null)],function(e,t){var n=t.component,i=e(t,2,0,t.parent.context.$implicit.htmlFile&&n.movePaginationDown,t.parent.context.$implicit.htmlFile&&!n.movePaginationDown&&!n.isUpsell);e(t,1,0,"section__buttons-container slide__buttons-container",i),e(t,4,0,t.parent.context.$implicit.buttons)},null)}function K(e){return i.Jb(0,[(e()(),i.pb(0,0,[[2,0],["slides",1]],null,11,"div",[["class","slide static"],["tabindex","-1"]],null,null,null,null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Cb(2,{active:0,previous:1,upcoming:2,first:3}),(e()(),i.pb(3,0,null,null,8,"div",[["class","absolute-wrapper"]],null,null,null,null,null)),(e()(),i.gb(16777216,null,null,1,null,N)),i.ob(5,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.gb(16777216,null,null,1,null,$)),i.ob(7,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.gb(16777216,null,null,1,null,H)),i.ob(9,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.gb(16777216,null,null,1,null,j)),i.ob(11,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null)],function(e,t){var n=t.component,i=e(t,2,0,n.currentSlide===t.context.index,n.currentSlide>t.context.index,n.currentSlide<t.context.index,t.context.first);e(t,1,0,"slide static",i),e(t,5,0,t.context.$implicit.image),e(t,7,0,t.context.$implicit.text),e(t,9,0,t.context.$implicit.htmlFile),e(t,11,0,t.context.$implicit.buttons)},null)}function W(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,3,"div",[["aria-hidden","true"]],null,null,null,null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{ngClass:[0,"ngClass"]},null),i.Cb(2,{active:0,last:1}),(e()(),i.Hb(-1,null,["â—"]))],function(e,t){var n=e(t,2,0,t.component.currentSlide===t.context.index,t.context.last);e(t,1,0,n)},null)}function q(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,4,"div",[["id","pagination"],["role","status"]],[[1,"aria-label",0]],null,null,null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{ngClass:[0,"ngClass"]},null),i.Cb(2,{"pagination--customized-card":0}),(e()(),i.gb(16777216,null,null,1,null,W)),i.ob(4,278528,null,0,_.j,[i.N,i.K,i.r],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],function(e,t){var n=t.component,i=e(t,2,0,n.movePaginationDown);e(t,1,0,i),e(t,4,0,n.slides,n.trackByIndex)},function(e,t){e(t,0,0,t.component.getPaginationAriaLabel())})}function Z(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,0,"img",[["class","microsoft-icon"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,function(e,t){var n=t.component;e(t,0,0,n.microsoftIcon,n.microsoftLogo)})}function Q(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,6,"a",[["class","arrow arrow-lt welcome-icon-sprite"],["href","javascript:void(0)"],["id","first-run-arrow-lt"],["role","button"]],[[1,"data-area",0],[1,"aria-label",0],[8,"title",0],[24,"@leftArrowInOut",0]],[[null,"click"],[null,"focus"],[null,"blur"]],function(e,t,n){var i=!0,l=e.component;return"click"===t&&(i=!1!==l.previousSlide()&&i),"focus"===t&&(i=!1!==l.focusLeftArrow()&&i),"blur"===t&&(i=!1!==l.blurLeftArrow()&&i),i},null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Ab(2,2),(e()(),i.pb(3,0,null,null,3,"div",[["class","relative-wrapper"]],null,null,null,null,null)),(e()(),i.pb(4,0,null,null,0,"div",[["class","arrow-bg"]],null,null,null,null,null)),(e()(),i.pb(5,0,null,null,1,"div",[["class","arrow-icon welcome-icon-sprite"]],null,null,null,null,null)),i.ob(6,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],function(e,t){var n=t.component,i=e(t,2,0,n.isRtl?"welcome-icon-sprite-arrow-dark-rt":"welcome-icon-sprite-arrow-dark-lt",n.isCapturingIntent?"arrow--capturing-intent arrow-lt--capturing-intent":"");e(t,1,0,"arrow arrow-lt welcome-icon-sprite",i),e(t,6,0,"arrow-icon welcome-icon-sprite",n.isRtl?"welcome-icon-arrow-right":"welcome-icon-arrow-left")},function(e,t){var n=t.component;e(t,0,0,n.componentArea,n.backButtonAriaLabel,n.backButtonAriaLabel,void 0)})}function X(e){return i.Jb(0,[(e()(),i.pb(0,0,null,null,6,"a",[["class","arrow arrow-rt welcome-icon-sprite"],["href","javascript:void(0)"],["id","first-run-arrow-rt"],["role","button"]],[[1,"data-area",0],[1,"aria-label",0],[8,"title",0]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.nextSlide()&&i),i},null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Ab(2,3),(e()(),i.pb(3,0,null,null,3,"div",[["class","relative-wrapper"]],null,null,null,null,null)),(e()(),i.pb(4,0,null,null,0,"div",[["class","arrow-bg"]],null,null,null,null,null)),(e()(),i.pb(5,0,null,null,1,"div",[["class","arrow-icon welcome-icon-sprite"]],null,null,null,null,null)),i.ob(6,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],function(e,t){var n=t.component,i=e(t,2,0,n.show?"active":"",n.currentSlide+1===n.slides.length?"completion-state welcome-icon-sprite-check-dark":n.isRtl?"welcome-icon-sprite-arrow-dark-lt":"welcome-icon-sprite-arrow-dark-rt",n.isCapturingIntent?"arrow--capturing-intent arrow-rt--capturing-intent":"");e(t,1,0,"arrow arrow-rt welcome-icon-sprite",i),e(t,6,0,"arrow-icon welcome-icon-sprite",n.currentSlide+1===n.slides.length?"welcome-icon-checkmark":n.isRtl?"welcome-icon-arrow-left":"welcome-icon-arrow-right")},function(e,t){var n=t.component;e(t,0,0,n.componentArea,n.currentSlide+1===n.slides.length?n.completeButtonAriaLabel:n.nextButtonAriaLabel,n.currentSlide+1===n.slides.length?n.completeButtonAriaLabel:n.nextButtonAriaLabel)})}function Y(e){return i.Jb(0,[(e()(),i.pb(0,0,[[1,0],["welcomeOverlay",1]],null,29,"div",[["aria-modal","true"],["class","o365cs-base page-overlay"],["endId","first-run-arrow-rt"],["id","welcome-overlay"],["ohpFocusContext",""],["ohpViewCacheOperation","remove-node"],["role","dialog"]],[[1,"data-view-cache-operation",0],[1,"data-view-cache-parameters",0]],null,null,null,null)),i.ob(1,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Ab(2,3),i.ob(3,4341760,null,0,B.a,[c.a,i.k,r.a,i.C,g.b],{startId:[0,"startId"],endId:[1,"endId"]},null),i.ob(4,16384,null,0,O.a,[],{viewCacheOperation:[0,"viewCacheOperation"]},null),(e()(),i.pb(5,0,null,null,2,"div",[["class","page-overlay__background"],["id","welcome-bg"]],null,null,null,null,null)),i.ob(6,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Cb(7,{"welcome-bg--high-opacity":0}),(e()(),i.pb(8,0,null,null,21,"div",[["id","welcome-wrapper"]],null,null,null,null,null)),(e()(),i.pb(9,0,null,null,20,"div",[["class","first-run-elements-container"]],null,null,null,null,null)),(e()(),i.pb(10,0,null,null,15,"div",[["id","slide-container"]],null,null,null,null,null)),i.ob(11,278528,null,0,_.i,[i.r,i.s,i.k,i.C],{ngClass:[0,"ngClass"]},null),i.Cb(12,{"slide-container--animated":0,"slide-container--capturing-intent":1,"slide-container--upsell":2}),(e()(),i.gb(16777216,null,null,1,null,V)),i.ob(14,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.pb(15,0,null,null,10,"div",[["class","relative-wrapper"]],null,null,null,null,null)),(e()(),i.gb(16777216,null,null,1,null,K)),i.ob(17,278528,null,0,_.j,[i.N,i.K,i.r],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),i.gb(16777216,null,null,1,null,q)),i.ob(19,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.pb(20,0,null,null,5,"div",[["class","slide"],["id","persist"]],null,null,null,null,null)),(e()(),i.gb(16777216,null,null,1,null,Z)),i.ob(22,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.pb(23,0,null,null,2,"a",[["href","javascript:void(0)"],["id","close-welcome-overlay"],["role","button"]],[[1,"data-area",0],[1,"aria-label",0],[8,"title",0]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.dismiss()&&i),i},null,null)),(e()(),i.pb(24,0,null,null,1,"ohp-icon-font",[["iconFontName","X2"],["size","18"]],null,null,null,U.b,U.a)),i.ob(25,638976,null,0,M.a,[p.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null),(e()(),i.gb(16777216,null,null,1,null,Q)),i.ob(27,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null),(e()(),i.gb(16777216,null,null,1,null,X)),i.ob(29,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null)],function(e,t){var n=t.component,i=e(t,2,0,n.show?"show":"",n.complete?"welcome-complete":"","slide-"+(n.currentSlide+1));e(t,1,0,"o365cs-base page-overlay",i),e(t,3,0,n.slideFocusElement,"first-run-arrow-rt"),e(t,4,0,"remove-node");var l=e(t,7,0,n.shouldUseHighOpacity);e(t,6,0,"page-overlay__background",l);var s=e(t,12,0,n.shouldUseCssAnimation,n.isCapturingIntent,n.isUpsell);e(t,11,0,s),e(t,14,0,n.announcementEnabled),e(t,17,0,n.slides,n.trackByIndex),e(t,19,0,n.slides.length>1),e(t,22,0,n.microsoftIcon),e(t,25,0,"X2","18"),e(t,27,0,n.show&&n.currentSlide>0),e(t,29,0,!n.isUpsell)},function(e,t){var n=t.component;e(t,0,0,i.zb(t,4).viewCacheOperation,i.zb(t,4).viewCacheParameters),e(t,23,0,n.componentArea,n.closeButtonAriaLabel,n.closeButtonAriaLabel)})}function ee(e){return i.Jb(0,[i.Bb(0,R,[]),i.Fb(671088640,1,{welcomeOverlay:0}),i.Fb(671088640,2,{slideElements:1}),(e()(),i.gb(16777216,null,null,1,null,Y)),i.ob(4,16384,null,0,_.k,[i.N,i.K],{ngIf:[0,"ngIf"]},null)],function(e,t){e(t,4,0,t.component.visible)},null)}var te=i.lb("ohp-first-run",x,function(e){return i.Jb(0,[(e()(),i.pb(0,16777216,null,null,1,"ohp-first-run",[],null,null,null,ee,z)),i.ob(1,4308992,null,0,x,[p.a,b.a,u.b,c.a,G.c,h.a,y.a,D.a,E.a,R,r.a,s.a,v.a,d.b,i.C,m.a,g.b,f.a,C,w.a,k.a,a.b,i.N],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),ne=n("xIlw"),ie=n("lQwO"),le=n("ej7j"),se=n("+P5Z"),re=n("qk26"),ae=n("VY7U"),oe=n("cxfp"),ue=n("CCRL");n.d(t,"FirstRunModuleNgFactory",function(){return ce});var ce=i.mb(T,[],function(e){return i.wb([i.xb(512,i.j,i.ab,[[8,[A.a,te]],[3,i.j],i.w]),i.xb(4608,_.m,_.l,[i.t,[2,_.w]]),i.xb(4608,R,R,[]),i.xb(1073742336,_.c,_.c,[]),i.xb(1073742336,ne.a,ne.a,[]),i.xb(1073742336,ie.a,ie.a,[]),i.xb(1073742336,le.a,le.a,[]),i.xb(1073742336,se.a,se.a,[]),i.xb(1073742336,re.o,re.o,[[2,re.u],[2,re.n]]),i.xb(1073742336,ae.a,ae.a,[]),i.xb(1073742336,oe.a,oe.a,[]),i.xb(1073742336,T,T,[]),i.xb(256,ue.a,F,[])])})},dz0V:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("31lE"),l=n("hhzZ");n("hZW2"),n("cgnd");class s{constructor(e,t,n,i,l){this.documentService=e,this.elementRef=t,this.instrumentationService=n,this.renderer=i,this.clientStartupConfigService=l,this.ignoreFocusChanges=!1}ngAfterViewInit(){try{this.startTabGuardrail=this.getGuardrail(!0),this.startScanGuardrail=this.getGuardrail(!1),this.parent=this.renderer.parentNode(this.elementRef.nativeElement),this.renderer.insertBefore(this.parent,this.startTabGuardrail,this.elementRef.nativeElement),this.renderer.insertBefore(this.parent,this.startScanGuardrail,this.elementRef.nativeElement);const e=this.renderer.nextSibling(this.elementRef.nativeElement);this.endTabGuardrail=this.getGuardrail(!0),this.endScanGuardrail=this.getGuardrail(!1),e?this.renderer.insertBefore(this.parent,this.endTabGuardrail,e):this.renderer.appendChild(this.parent,this.endTabGuardrail),this.renderer.insertBefore(this.parent,this.endScanGuardrail,this.endTabGuardrail),this.documentService.nativeDocument.addEventListener("focus",e=>this.onFocus(e),!0),this.lastFocusedElement=this.documentService.nativeDocument.activeElement}catch(e){this.instrumentError(e,"Open")}}ngOnDestroy(){this.documentService.nativeDocument.removeEventListener("focus",this.onFocus,!0),this.parent&&(this.startTabGuardrail&&this.renderer.removeChild(this.parent,this.startTabGuardrail),this.startScanGuardrail&&this.renderer.removeChild(this.parent,this.startScanGuardrail),this.endTabGuardrail&&this.renderer.removeChild(this.parent,this.endTabGuardrail),this.endScanGuardrail&&this.renderer.removeChild(this.parent,this.endScanGuardrail))}getGuardrail(e){const t=this.renderer.createElement("div");return this.renderer.setProperty(t,"tabIndex",e?0:-1),this.renderer.setStyle(t,"width",0),this.renderer.setStyle(t,"height",0),t}onFocus(e){try{if(this.ignoreFocusChanges||this.elementRef.nativeElement.contains(e.target))return void(this.lastFocusedElement=e.target);if(e.target===this.startScanGuardrail)return void this.focusElement(this.endScanGuardrail);if(e.target===this.endScanGuardrail)return void this.focusElement(this.startScanGuardrail);const t=this.elementRef.nativeElement.querySelector(`#${this.startId}`),n=this.elementRef.nativeElement.querySelector(`#${this.endId}`);if(!t||!n)return void(this.lastFocusedElement=e.target);this.focusElement(this.lastFocusedElement&&this.elementRef.nativeElement.contains(this.lastFocusedElement)&&e.target===this.startTabGuardrail?n:t)}catch(e){this.lastFocusedElement=this.documentService.nativeDocument.activeElement,this.instrumentError(e,"Focus")}}focusElement(e){this.ignoreFocusChanges=!0;try{e.focus()}catch(e){}this.ignoreFocusChanges=!1}instrumentError(e,t){if(!e)return;const n={};n.Error=new l.d(e.toString(),this.clientStartupConfigService.config.logPiiInClearText?i.AWTPiiKind.NotSet:i.AWTPiiKind.GenericData),n.Action=t,this.instrumentationService.logGenericEvent("Focus_Context_Error",n)}}},"vSs+":function(e,t,n){"use strict";n.d(t,"a",function(){return S});var i=n("70cc"),l=n("WKA6"),s=n("lrJm"),r=n("y3b+"),a=n("hhzZ"),o=n("hZW2"),u=n("7Gwk"),c=n("Uqr9"),h=n("casz"),d=n("TIi1"),m=n("4/We"),p=n("cgnd"),g=n("/I02"),f=n("pjz5"),b=n("Mlb/"),v=n("Qo/9");class S{constructor(e,t,n,i,l,s,r,a,o,u,c,h){this.cookieService=e,this.eventService=t,this.capabilitiesService=n,this.clientStartupConfigService=i,this.contextService=l,this.documentService=s,this.globalErrorHandler=r,this.installConfigService=a,this.instrumentationService=o,this.performanceService=u,this.schedulerService=c,this.urlLauncherService=h,this.upsellTrackingParam="",this.dimeDisabled=!1}getUpsellTrackingParam(){if(this.capabilitiesService.capabilities.isPwaInUwp){if(""===this.upsellTrackingParam){if(this.upsellTrackingParam="PWA",MyOffice.RuntimeComponents&&MyOffice.RuntimeComponents.ClientSystem)try{const e=MyOffice.RuntimeComponents.ClientSystem.getDeviceOEMIdentifier();this.upsellTrackingParam=`PWA-${e}`}catch(e){this.globalErrorHandler.handleError(e,"t90JZ")}const e="launchByWordPad";("wordpad"===this.clientStartupConfigService.config.sharedClientStartupContext.requestOrigin.toLowerCase()||this.cookieService.get(e))&&(this.upsellTrackingParam+="-WordPad")}}else this.upsellTrackingParam="HomePage";return this.upsellTrackingParam}broadcastUpsell(){this.eventService.broadcastEvent({name:"premiumTemplatesUpsellStarted",args:[]})}warmupDime(){return this.warmupDimePromise?this.warmupDimePromise:(this.logDimeEvent("Dime_Warmup"),this.warmupDimePromise=new Promise(e=>{this.eventService.events.withScope(0).pipe(Object(i.a)(e=>"mruFailed"===e.name||"mruReady"===e.name),Object(l.a)(1)).toPromise().then(()=>{this.schedulerService.scheduleWork(()=>{this.loadDime().then(e=>{1===e&&this.preloadDimeExperience()})},4),e()})}),this.warmupDimePromise)}launchDime(e,t){if(this.dimeDisabled)return this.urlLauncherService.openUrl(t,"Upsell"),void this.logDimeEvent("Dime_Launch",e,"Failed","RedirectToPOC;DimeDisabled");let n=null;const i=this.loadDime(),l=new Promise(e=>{n=setTimeout(()=>{e(0)},this.installConfigService.config.dimeTimeoutMs)});return Promise.race([i,l]).then(i=>{if(n&&clearTimeout(n),1!==i)return this.dimeDisabled=!0,void this.logDimeEvent("Dime_Launch",e,"Failed","TimeOut");try{const n=this.getCampainIdFromTargetUrl(t),i={experience:e,campaignId:n};this.logDimeEvent("Dime_Launch",e,"Start"),this.dime.launch(i,()=>{this.logDimeEvent("Dime_Impression",e)}).then(t=>{this.logDimeEvent("Dime_Completed",e,t.status,t.metaData)})}catch(n){this.dimeDisabled=!0,this.logDimeEvent("Dime_Launch",e,"Failed",n,"RedirectToPOC;LaunchException"),this.urlLauncherService.openUrl(t,"Upsell")}})}loadDime(){return this.loadDimePromise?this.loadDimePromise:(this.performanceService.mark("LoadDimeScript_Started"),this.loadDimePromise=new Promise(e=>{this.documentService.addScriptToPage(this.installConfigService.config.dimeJSUrl,()=>{this.logDimeEvent("Dime_LoadScript","","Succeeded"),this.performanceService.mark("LoadDimeScript_Completed"),this.initializeDime().then(()=>{e(1)}).catch(()=>{e(2)})},()=>{this.logDimeEvent("Dime_LoadScript","","Failed"),e(2)},!1,"dimeScript")}),this.loadDimePromise)}getCampainIdFromTargetUrl(e){if(e&&e.indexOf("ocid=")>0){const t=f.a.getLocation(e),n=f.a.getQueryParams(t.search);return""!==n.ocid?n.ocid:"PROD_OfficeCom"}return"PROD_OfficeCom"}initializeDime(){return new Promise((e,t)=>{if(this.dime&&e(1),this.dimeDisabled&&e(2),"undefined"!=typeof Dime){this.performanceService.mark("DimeInitialize_Start");const n={partnerId:this.capabilitiesService.capabilities.pwaEnabled?"officepwa":"officedotcom",language:this.contextService.sharedContext.officeMarket,sessionId:this.clientStartupConfigService.config.sharedClientStartupContext.sessionId,authHint:this.capabilitiesService.capabilities.pwaEnabled?this.clientStartupConfigService.config.puid:this.clientStartupConfigService.config.userPrincipalName};try{this.dime=new Dime(n),this.performanceService.mark("DimeInitialize_Complete"),this.logDimeEvent("Dime_Initialize","","Succeeded"),e(1)}catch(e){this.dimeDisabled=!0,this.logDimeEvent("Dime_Initialize","","Failed",e),t()}}else this.dimeDisabled=!0,this.logDimeEvent("Dime_Initialize","","Failed","Dime_Undefined"),t()})}preloadDimeExperience(){this.dime&&(this.performanceService.mark("DimePreload_Start"),this.logDimeEvent("Dime_Preload","","Start"),this.dime.preload({experiences:["installbutton","buybutton"]}).catch(e=>this.logDimeEvent("Dime_Preload","","Failed",e)))}logDimeEvent(e,t="",n="",i,l){const s={};s.DimeExperience=t,s.State=n;const r=l?l+";":"";s.DebugInfo="string"==typeof i?r+i:i?r+JSON.stringify(i):r,this.instrumentationService.logGenericEvent(e,s)}}S.ngInjectableDef=b.R({factory:function(){return new S(b.V(v.d),b.V(u.a),b.V(m.a),b.V(p.b),b.V(g.a),b.V(o.a),b.V(s.b),b.V(r.a),b.V(a.a),b.V(c.b),b.V(h.a),b.V(d.a))},token:S,providedIn:"root"})},"y3b+":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("dFxn"),l=n("Mlb/");class s{constructor(e){this.config=e.parse("installConfig")||{consumerDirectInstallUrl:"",consumerInstallLink:"",commercialMySoftwarePageUrl:"",dimeEnabled:!1,dimeJSUrl:"",dimeTimeoutMs:5e3,goPremiumUrl:"",installApiRoot:"",installApiSWEnabled:!1,resources:null,sendRequestId:!1,wizardImageAssets:"",wizardSupportLink:"",buyOffice365Url:"",haveOfficeProductKeyUrl:"",needHelpInstallingOfficeUrl:""}}}s.ngInjectableDef=l.R({factory:function(){return new s(l.V(i.a))},token:s,providedIn:"root"})}}]);
//# sourceMappingURL=pwa-first-run.07538afde70256b2cb3b.chunk.v2.js.map