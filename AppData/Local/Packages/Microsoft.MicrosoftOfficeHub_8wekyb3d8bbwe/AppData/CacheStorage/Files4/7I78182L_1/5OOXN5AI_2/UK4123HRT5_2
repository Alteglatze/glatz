!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="QCi+")}({Dvqm:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n("swXz");function o(e,t,n){var o=function(){if(/^(?:interactive|complete)$/.test(document.readyState)){document.removeEventListener("readystatechange",o);var i=e(),a={root:{clientNode:t(),serverNode:i,overlay:Object(r.a)(document)},events:[]},s={opts:{},apps:[a],listeners:[]};window.prebootData=s,n.forEach(function(e){e.hasOwnProperty("replay")||(e.replay=!0),Object(r.c)(document,s,a,e)})}};document.addEventListener("readystatechange",o)}function i(e,t,n,r,o,i){return void 0===n&&(n=!0),void 0===r&&(r=["click"]),void 0===o&&(o=!1),void 0===i&&(i=!1),{selector:e,action:t,replay:n,events:r,freeze:o,preventDefault:i}}},"QCi+":function(e,t,n){"use strict";n.r(t);var r=n("Dvqm"),o=n("yxA9"),i=new(function(){function e(){this.currentMsaUser=null,this.currentUserAccount=null,this.currentUserPhoto="",this.currentUserPhotoPromise=null,this.initializedAccountsPane=!1,this.isUserInteractionErrorHandled=!1,this.userInteractionRequired=!1;var t=window.navigator.serviceWorker;window.diskPreloadRequestMap=new Map,window.diskPreloadUserIdStorageKey="PwaDiskPreloadUserStorageId",window.wamAccessTokenRequests=new Map,window.diskPreloadUrlStorageKey=e.DiskPreloadStorageKey,window.pwaCurrentUserId=null,window.windowsDataSecuritySetting=0,window.shellTokenRequestDictionary={},window.pwaResuming=!1,window.startedFromServiceWorker=!(!t||!t.controller),this.swEnabled=!!t,"0"===window.forcedMockAuth?this.requiredMockAuthority=window.forcedMockAuth:"1"===window.forcedMockAuth?this.requiredMockAuthority=e.MsaAuthority:"2"===window.forcedMockAuth&&(this.requiredMockAuthority=e.AadAuthority),this.currentUrl=new URL(window.location.href),this.isUwp=navigator&&navigator.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows,this.localSettingsProps=this.isUwp?Windows.Storage.ApplicationData.current.localSettings.values:null,this.elementsDisplayStyleMap=new Map([[e.UnauthPageId,"flex"],[e.ExtendedSplashScreenId,"flex"],[e.OfficeHomeId,"flex"],[e.ErrorPageId,"inline-block"],[e.ViewCacheId,"block"]]),e.SessionExpiredToastTemplate='<toast><visual><binding template="ToastGeneric"><text>Office</text><text>'+e.ToastMessageKey+"</text></binding></visual></toast>"}return e.prototype.canRender=function(){return this.isUwp||this.requiredMockAuthority},e.prototype.initVars=function(){var t=this;if(window.MSApp&&window.MSApp.pageHandlesAllApplicationActivations(!0),o.c.InitializeCIDSID("OHPWA.SID","/"),this.markPerformance(e.InitialPerformanceEvent,0),this.getSharedClientStartupConfig().then(function(e){var n={PageResponseCid:e?e.correlationId:""};t.logAriaEvent(o.d.GenericEvent,"Pwa_Begin",0,n)}),this.isUwp){try{Windows.System.Profile.PlatformDiagnosticsAndUsageDataSettings.addEventListener("collectionlevelchanged",function(){return t.resetSecurityLevel()}),this.resetSecurityLevel()}catch(e){}if(!sessionStorage.getItem(e.ExistingSessionKey)){try{var n=Windows.System.Diagnostics.ProcessDiagnosticInfo.getForCurrentProcess().processStartTime.getTime(),r={Latency:(window.performance.timing.navigationStart-n).toString(),ItemCategory:"Inline"};this.logAriaEvent(o.d.PerformanceDump,"Splashscreen",0,r)}catch(e){var i={Error:"Splashscreen",DebugInfo:e,ItemCategory:"Inline"};this.logAriaEvent(o.d.GenericEvent,o.d.PerformanceMarkFailure,2,i)}sessionStorage.setItem(e.ExistingSessionKey,"true")}try{Windows.UI.WebUI.WebUIApplication.addEventListener("activated",function(e){return t.onActivate(e)}),Windows.UI.WebUI.WebUIApplication.addEventListener("suspending",function(e){return t.onSuspend(e)}),Windows.UI.WebUI.WebUIApplication.addEventListener("resuming",function(e){return t.onResume(e)}),Windows.UI.WebUI.WebUIApplication.addEventListener("navigated",function(e){return t.onNavigate(e)}),Windows.UI.WebUI.WebUIApplication.addEventListener("enteredbackground",function(e){return t.onEnterBackground(e)}),Windows.UI.WebUI.WebUIApplication.addEventListener("leavingbackground",function(e){return t.onLeaveBackground(e)})}catch(e){this.logAriaEvent(o.d.GenericEvent,"SubscribeToLifecycleEvents_Error",2)}if(window.thirdPartyNoticeUrl&&this.waitForPageLoad().then(function(){return t.installThirdPartyNotice()}),this.localSettingsProps.hasKey(e.CurrentAuthorityKey)&&this.localSettingsProps.hasKey(e.CurrentAccountIdKey)){var a=this.localSettingsProps.lookup(e.CurrentAuthorityKey);window.pwaCurrentUserId=this.getUserIdKey(a,this.localSettingsProps.lookup(e.CurrentAccountIdKey))}}else window.windowsDataSecuritySetting=3},e.prototype.initApp=function(){var t=this;this.isUwp&&this.localSettingsProps&&this.localSettingsProps.hasKey(e.PrelaunchModeKey)&&this.setPrelaunchMode();var n=function(){t.logAriaEvent(o.d.GenericEvent,"Pwa_Unauth_PageView",0),t.swEnabled&&navigator.serviceWorker.getRegistration(e.BasePwaPath).then(function(e){o.c.NotifyInstallingWorkerAppFailed(e,!1)}),t.waitForPageLoad().then(function(){t.displayScreen(e.UnauthPageId),document.getElementById("sign-in-button").onclick=function(){t.logAriaEvent(o.d.GenericClick,"Pwa_SignIn_Click",0),t.showAccountsPane()},document.getElementById("create-account-link").onclick=function(){t.logAriaEvent(o.d.GenericClick,"Pwa_Create_Account_Click",0)},t.markPerformance("Pwa_Unauth_Ready",0,e.InitialPerformanceEvent),t.flushLogs()})};if("0"!==this.requiredMockAuthority){if(this.localSettingsProps&&this.localSettingsProps.hasKey(e.SignOutWindowNameKey)){try{window.open("about:blank",e.SignOutWindowName,"msHideView=yes").close(),this.localSettingsProps.remove(e.SignOutWindowNameKey)}catch(e){}this.logAriaEvent(o.d.GenericEvent,"SignOut_Completed",2)}this.isUwp?this.getAccountProvider().then(function(e){e?t.bootstrapApp(t.isConsumerAuthority(e.authority)):n()}).catch(function(e){e&&t.logAriaEvent(o.d.GenericEvent,"GetAccountProvider_Error",2),t.showErrorPage()}):this.bootstrapApp(this.isConsumerAuthority(this.requiredMockAuthority)),this.setupPreboot(),this.setupRemoveSplashScreenListener()}else n()},e.prototype.initializeGlobalFunctions=function(){var t=this;window.openThirdPartyNotice=function(){var e=function(){var e=new Windows.Foundation.Uri(window.thirdPartyNoticeUrl);Windows.System.Launcher.launchUriAsync(e).then(function(e){if(!e)throw new Error}).then(null,function(){t.logAriaEvent(o.d.GenericEvent,"OpenThirdPartyNotice_Error",2)})};t.thirdPartyLicenseNotice?Windows.System.Launcher.launchFileAsync(t.thirdPartyLicenseNotice).then(function(t){t||e()},e):e()},window.switchAccount=function(){t.localSettingsProps.insert(e.SwitchAccountKey,!0),t.logAriaEvent(o.d.GenericEvent,"SwitchAccount_Start",2),t.showAccountsPane(!0)},window.uwpSignOut=function(){t.logAriaEvent(o.d.GenericEvent,"SignOut_Started",2),window.open("/pwa/logout",e.SignOutWindowName,"msHideView=yes",!1),t.resetBrowserStorage(),t.localSettingsProps.clear(),t.localSettingsProps.insert(e.SignOutWindowNameKey,e.SignOutWindowName),t.localSettingsProps.insert(e.SignedOutKey,!0),t.reloadApp()},window.getWamAccessToken=function(e,n){return t.getAccountProvider().then(function(r){return r?t.getWamTokenResult(n,e,r):Promise.reject("Cannot get user account")}).then(function(e){return t.buildAccessTokenResponse(e)})}},e.prototype.getAccountProvider=function(){var t=this;return this.currentAccountProvider?Promise.resolve(this.currentAccountProvider):this.localSettingsProps.hasKey(e.SignedOutKey)?Promise.resolve(null):new Promise(function(n,r){var o=t.localSettingsProps.lookup(e.CurrentUserProviderIdKey),i=t.localSettingsProps.lookup(e.CurrentAuthorityKey);(o&&i?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(o,i):Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.LocalProviderId)).then(function(n){return!n||n.authority!==e.MsaAuthority&&n.authority!==e.AadAuthority||t.requiredMockAuthority&&n.authority!==t.requiredMockAuthority?null:n.id===e.LocalProviderId?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,n.authority):n}).then(function(e){e&&t.saveAccountProvider(e),n(e)})})},e.prototype.getReactShellConfig=function(){return this.reactShellConfig||(this.reactShellConfig=this.parseJsonElementWithId(e.ShellConfigElementId)),this.reactShellConfig},e.prototype.buildAccessTokenResponse=function(e){if(!this.checkWamTokenResult(e))return null;var t=e.responseData[0],n=t.webAccount.webAccountProvider,r=t.properties&&t.properties.hasKey("exp")&&1e3*parseInt(t.properties.lookup("exp")),o=this.isConsumerAuthority(n.authority);return{success:!0,token:e.responseData[0].token,expiryMs:r||!o&&this.getDefaultExpiry(),format:n&&o?"RPSCompact":"JWT",source:"WAM"}},e.prototype.getDefaultExpiry=function(){return(new Date).getTime()+o.a},e.prototype.isAsianCulture=function(e){return!!e&&["ja","ko","zh"].some(function(t){return 0===e.indexOf(t)})},e.prototype.getUserDisplayName=function(e){var t="";if(this.currentUserAccount){var n=this.currentUserAccount.properties.hasKey("FirstName")?this.currentUserAccount.properties.lookup("FirstName"):"",r=this.currentUserAccount.properties.hasKey("LastName")?this.currentUserAccount.properties.lookup("LastName"):"";t=n&&r?this.isAsianCulture(e)?r+n:n+" "+r:n||r||this.currentUserAccount.userName}return t},e.prototype.getUserIdKey=function(e,t){return e+"_"+t},e.prototype.getCurrentAccount=function(t){var n=this;return this.currentUserAccount?Promise.resolve(this.currentUserAccount):t&&this.localSettingsProps.hasKey(e.CurrentAccountIdKey)?this.findAccountAsync(t).then(function(e){return n.currentUserAccount=e,n.setupCurrentUser(t.authority,e.id),e}):Promise.reject()},e.prototype.findAccountAsync=function(t){var n=this,r=o.d.CurrentTime(),i=new Promise(function(r,o){Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountAsync(t,n.localSettingsProps.lookup(e.CurrentAccountIdKey)).then(r,o)}),a=function(e,t){n.logRequest("FindAccount_Request",Math.ceil(o.d.CurrentTime()-r),e,2,!1,t)};return i.then(function(t){if(!t){var r="Failed to find account";return a(!1,r),n.localSettingsProps.remove(e.CurrentAccountIdKey),Promise.reject(r)}return a(!0),Promise.resolve(t)},function(t){return a(!1,t),n.localSettingsProps.remove(e.CurrentAccountIdKey),Promise.reject(t)})},e.prototype.cleanUpShellAndConfigCallbacks=function(){this.shellAndConfigPromiseResolver=null,this.shellAndConfigPromiseRejecter=null},e.prototype.logAriaEvent=function(e,t,n,r,i){r=r||{},this.currentAccountProvider&&(r.AuthType=this.isConsumerAuthority(this.currentAccountProvider.authority)?"MSA":"OrgId"),o.d.LogEvent(e,t,n,r,i)},e.prototype.logRequest=function(e,t,n,r,i,a,s){(s=s||{}).Latency=t.toString(),s.State=n?"Succeeded":"Failed",s.FromServiceWorkerCache=(!!i).toString(),a&&(s.Error=a.toString()),this.logAriaEvent(o.d.GenericRequest,e,r,s)},e.prototype.markPerformance=function(t,n,r){o.d.MarkPerformance(t,r,n,window.windowsDataSecuritySetting,{Page:e.PwaPage})},e.prototype.checkWamTokenResult=function(e){return e&&e.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.success&&e.responseData&&e.responseData.length>0},e.prototype.getWamTokenResult=function(t,n,r,i){var a,s=this,c=o.d.CurrentTime(),u="";if(this.isConsumerAuthority(r.authority))a=new Windows.Security.Authentication.Web.Core.WebTokenRequest(r,n,"none");else{var d=t===e.OfficeApiResource?"openid":"";(a=new Windows.Security.Authentication.Web.Core.WebTokenRequest(r,d,"0ec893e0-5785-4de6-99da-4ed124e5296c")).properties.insert("resource",n)}var l=new Promise(function(n,o){if(!a)return u="InvalidTokenRequest",void o();var i=function(e){s.getWamToken(t,e).then(n,o)};s.localSettingsProps.hasKey(e.SwitchAccountKey)?i(a):s.getCurrentAccount(r).then(function(e){return s.getWamTokenSilently(t,a,e)}).then(function(e){n(e)}).catch(function(){i(a)})}),p=!0;if(l.catch(function(){p=!1}).then(function(){var e={Resource:t};s.logRequest("GetWamTokenResult_Request",Math.ceil(o.d.CurrentTime()-c),p,0,!1,u,e)}),i){var h={pending:!0,result:l.then(function(e){return s.buildAccessTokenResponse(e)})};window.wamAccessTokenRequests.set(n,h)}return l},e.prototype.getWamToken=function(t,n){var r=this,i=new Promise(function(t,i){Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.requestTokenAsync(n).then(function(n){if(n&&n.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.userCancel&&r.userInteractionRequired){if(r.isUserInteractionErrorHandled)return;if(e.SessionExpiredToastMessage)try{var i=new Windows.Data.Xml.Dom.XmlDocument;i.loadXml(e.SessionExpiredToastMessage);var a=new Windows.UI.Notifications.ToastNotification(i);Windows.UI.Notifications.ToastNotificationManager.createToastNotifier().show(a),r.logAriaEvent(o.d.GenericEvent,"UserSessionExpired",0)}catch(e){r.logAriaEvent(o.d.GenericEvent,"CreateSessionExpiredToast_Error",0,{Error:"string"==typeof e?e:e?e.message:""})}else r.logAriaEvent(o.d.GenericEvent,"MissingSessionExpiredToastMessage",0);r.isUserInteractionErrorHandled=!0,window.uwpSignOut()}else t(n)},i)});return this.instrumentedTokenFetch(i,"GetWamToken_Request",t)},e.prototype.getWamTokenSilently=function(e,t,n){var r=this,o=new Promise(function(e,o){(n?Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.getTokenSilentlyAsync(t,n):Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.getTokenSilentlyAsync(t)).then(function(t){window.enableUIRForceSignOut&&t&&t.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.userInteractionRequired&&t.responseError&&(2156265478===t.responseError.errorCode||2156265484===t.responseError.errorCode)&&(r.userInteractionRequired=!0),e(t)},o)});return this.instrumentedTokenFetch(o,"GetWamTokenSilently_Request",e)},e.prototype.instrumentedTokenFetch=function(e,t,n){var r=this,i=o.d.CurrentTime(),a=function(e,a,s){var c={Resource:n,DebugInfo:a.toString()};r.logRequest(t,Math.ceil(o.d.CurrentTime()-i),e,0,!1,s,c)};return e.then(function(e){if(!r.checkWamTokenResult(e)){var t=e&&e.responseError;return a(!1,e&&e.responseStatus,t?t.errorCode+": "+t.errorMessage:""),Promise.reject(e)}return a(!0,e.responseStatus),Promise.resolve(e)},function(e){return a(!1,-1,e),Promise.reject()})},e.prototype.processShellConfigApiData=function(t,n){var r=this,i=null;try{i=JSON.parse(t)}catch(e){i=t}if(!i)throw new Error("Empty shell and config response");this.configRetrieved=!0;var a=i.clientStartupConfiguration?JSON.parse(i.clientStartupConfiguration):null,s={ShellAndConfigCid:a?a.sharedClientStartupContext.correlationId:""};if(this.logAriaEvent(o.d.GenericEvent,"ShellAndConfigApi_Response",0,s),i.pwaConfig){var c=JSON.parse(i.pwaConfig);if(c){if(c.resourceUrlMap&&this.isUwp){var u=Object.entries(c.resourceUrlMap),d=new Set(c.deferredTokens||[]);u.forEach(function(e){var t=e[0],n=e[1];d.has(t)||r.getWamTokenResult(t,n,r.currentAccountProvider,!0),"WCSS"!==t&&"Graph"!==t||(window.shellTokenRequestDictionary[n]=function(){return window.wamAccessTokenRequests.has(n)?window.wamAccessTokenRequests.get(n).result.then(function(e){return e?e.token:null}):r.getWamTokenResult(t,n,r.currentAccountProvider,!0).then(function(e){return r.checkWamTokenResult(e)?e.responseData[0].token:null})})})}c.sessionExpiredToastMessage&&(e.SessionExpiredToastMessage=e.SessionExpiredToastTemplate.replace(e.ToastMessageKey,c.sessionExpiredToastMessage))}}if(i.navBarData){var l=JSON.parse(i.navBarData);window.navBarData=l}if(n&&this.isUwp&&(this.currentMsaUser={upn:this.currentUserAccount.userName,puid:this.currentUserAccount.properties.hasKey("UID")?this.currentUserAccount.properties.lookup("UID"):"",userDisplayName:this.getUserDisplayName(Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.languages[0])},window.userPrincipalName=this.currentUserAccount.userName),this.shellShimReady&&!this.reactShellBootstrapped&&this.waitForPageLoad().then(function(){return r.bootstrapReactShell(r.getReactShellConfig())}),i.feedbackConfig&&a&&i.sharedContext){var p=JSON.parse(i.feedbackConfig),h=JSON.parse(i.sharedContext);window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.initOptions={appId:p.appId,stylesUrl:p.stylesUrl,intlUrl:p.intlUrl,environment:p.environment,sessionId:window.overrideCID,build:a.sharedClientStartupContext.buildId,locale:h.officeMarket,screenshot:p.screenshotEnabled,userEmail:p.autopopulateEmail?a.userPrincipalName:""}}return i},e.prototype.requestConfigAndShellApiData=function(e,t,n){var r=this,i=this.swEnabled?window.navigator.serviceWorker.controller:null,a=new Headers;!e&&n&&a.append("Authorization","Bearer "+n),i&&(a.append("X-SW-OHP-FetchStrategy",t?"cache-only":"network-first"),window.pwaCurrentUserId&&a.append("X-SW-OHP-UserCacheId",window.pwaCurrentUserId)),a.append("X-OfficeHome-CorrelationId",window.overrideCID);var s={method:"GET",headers:a,cache:"default",credentials:"include"},c=new URL(this.currentUrl.origin+"/"+(window.configApiPath||"api/shellandconfigdata/pwa")+this.currentUrl.search);o.c.SetQueryParam(c,this.requiredMockAuthority?"mockauth":"auth",e?"1":"2"),o.c.SetQueryParam(c,"workload","pwa");var u=new Request(c.toString(),s),d=o.d.CurrentTime(),l=fetch(u),p=function(e,n){var i={HttpCode:n.toString(),DebugInfo:c.href};r.logRequest("ShellAndConfig_Request",Math.ceil(o.d.CurrentTime()-d),e,0,t,"",i)};return l.then(function(e){p(e.ok,e.status)},function(){p(!1,t?709:700)}),l.then(function(e){if(e.status>=200&&e.status<300)return e;throw Error(e.statusText)}).then(function(e){return e.json()})},e.prototype.getOfficeToken=function(t){var n=this;return this.getWamTokenResult(e.OfficeApiResource,this.isConsumerAuthority(t.authority)?"service::office.com::MBI_SSL":"4345a7b9-9a63-4910-a426-35363201d503",t,!0).then(function(r){return n.currentUserAccount=r.responseData[0].webAccount,n.localSettingsProps.insert(e.CurrentAccountIdKey,n.currentUserAccount.id),n.setupCurrentUser(t.authority,n.currentUserAccount.id),r})},e.prototype.saveAccountProvider=function(t){this.currentAccountProvider=t,this.localSettingsProps.insert(e.CurrentUserProviderIdKey,t.id),this.localSettingsProps.insert(e.CurrentAuthorityKey,t.authority)},e.prototype.clearSavedProvider=function(){this.currentAccountProvider=null,this.localSettingsProps.remove(e.CurrentUserProviderIdKey),this.localSettingsProps.remove(e.CurrentAuthorityKey)},e.prototype.getCurrentUserPhoto=function(){var t=this;this.currentUserAccount&&this.isConsumerAuthority(this.currentUserAccount.webAccountProvider.authority)&&!this.localSettingsProps.hasKey(e.SwitchAccountKey)&&(this.currentUserPhotoPromise||(this.currentUserPhotoPromise=new Promise(function(e){t.currentUserAccount.getPictureAsync(Windows.Security.Credentials.WebAccountPictureSize.size208x208).then(function(e){var t=new Windows.Storage.Streams.Buffer(e.size);return e.readAsync(t,e.size,Windows.Storage.Streams.InputStreamOptions.readAhead)}).then(function(e){t.currentUserPhoto=Windows.Security.Cryptography.CryptographicBuffer.encodeToBase64String(e)}).done(function(){return e(t.currentUserPhoto)},function(){t.logAriaEvent(o.d.GenericEvent,"GetUserPhoto_Error",2),e("")})})))},e.prototype.handleShellConfigError=function(e){var t={Error:"string"==typeof e?e:e?e.name:"",DebugInfo:e?e.message:""};this.logAriaEvent(o.d.GenericEvent,"ShellAndConfigData_Error",0,t),this.shellAndConfigPromiseRejecter("Failed to fetch config data"),this.cleanUpShellAndConfigCallbacks()},e.prototype.fetchAndHandleShellAndConfigResponse=function(e,t){var n=this;return this.requestConfigAndShellApiData(e,!1,t).then(function(t){var r=n.processShellConfigApiData(t,e);n.shellAndConfigPromiseResolver(r),n.cleanUpShellAndConfigCallbacks()}).catch(function(e){return n.handleShellConfigError(e)})},e.prototype.fetchTokenAndCallShellAndConfigApi=function(t){var n=this;if(this.shellAndConfigPromiseResolver&&this.shellAndConfigPromiseRejecter){var r=function(e){return"Error fetching token ("+(e?e.responseStatus:"")+") "+(e&&e.responseError?e.responseError.errorCode:"")},i=this.isConsumerAuthority(t.authority),a=!1,s=window.pwaCurrentUserId&&this.swEnabled&&window.navigator.serviceWorker.controller,c=s?this.getCurrentAccount(t).then(function(e){return n.requestConfigAndShellApiData(i,!0)}):null,u=i?this.getCurrentAccount(t).catch(function(e){return n.getOfficeToken(t)}).then(function(e){return n.requestConfigAndShellApiData(!0,!1)}):this.getOfficeToken(t).then(function(e){return n.requestConfigAndShellApiData(!1,!1,e.responseData[0].token)}),d=function(t){if(t&&t.responseStatus){n.clearSavedProvider(),n.localSettingsProps.remove(e.CurrentAccountIdKey),n.localSettingsProps.insert(e.SignedOutKey,!0);var i={Message:r(t)};return n.logAriaEvent(o.d.GenericEvent,"FetchOfficeToken_Error",0,i),void n.reloadApp()}n.handleShellConfigError(t)};u.then(function(e){if(!a){var t=n.processShellConfigApiData(e,i);n.shellAndConfigPromiseResolver(t),n.cleanUpShellAndConfigCallbacks(),a=!0}}).catch(function(e){s||a||(d(e),a=!0)}),c&&c.then(function(e){if(!a){var t=n.processShellConfigApiData(e,i);n.shellAndConfigPromiseResolver(t),n.cleanUpShellAndConfigCallbacks(),a=!0}}).catch(function(){var t=function(){u.catch(function(e){d(e),a=!0})};window.enableCacheMissReload&&!a?(a=!0,navigator.serviceWorker.getRegistration(e.BasePwaPath).then(function(e){return e.unregister()}).then(function(e){if(!e)throw new Error("unregister failed");n.logAriaEvent(o.d.GenericEvent,"CacheMissUnregister",0),n.reloadApp()}).catch(function(r){var i;n.logAriaEvent(o.d.GenericEvent,"CacheMissHandling_Error",0,((i={})[e.InstrumentationParamError]=r&&r.message?r.message.toString():"",i)),t()})):t()})}else this.logAriaEvent(o.d.GenericEvent,"MissingPromiseResolveReject_Error",0)},e.prototype.webAccountProviderCommandInvoked=function(t){var n=this;if(t&&t.webAccountProvider&&t.webAccountProvider.authority){var r=t.webAccountProvider;if(this.localSettingsProps.hasKey(e.SwitchAccountKey)){var i=this.currentAccountProvider;this.saveAccountProvider(r),this.displayScreen(e.ExtendedSplashScreenId);var a,s=o.d.CurrentTime();this.getOfficeToken(r).then(function(t){return a=o.d.CurrentTime(),n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_FetchedToken",2,{Latency:Math.ceil(a-s).toString()}),n.localSettingsProps.remove(e.SwitchAccountKey),n.resetBrowserStorage(),n.forceNewServiceWorker()}).then(function(){n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_Completed",2,{Latency:Math.ceil(o.d.CurrentTime()-a).toString()}),n.reloadApp()}).catch(function(){n.localSettingsProps.remove(e.SwitchAccountKey),n.saveAccountProvider(i),n.logAriaEvent(o.d.GenericEvent,"SwitchAccount_Error",2,{Latency:Math.ceil(o.d.CurrentTime()-s).toString()}),n.displayScreen(e.OfficeHomeId)})}else this.saveAccountProvider(r),this.displayScreen(e.ExtendedSplashScreenId,e.OfficeHomeId),this.getOfficeToken(r).then(function(e){n.bootstrapApp(n.isConsumerAuthority(r.authority),e.responseData[0].token)}).catch(function(t){t&&t.responseStatus&&t.responseStatus===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.userCancel?(n.logAriaEvent(o.d.GenericEvent,"UserCancelSignIn",2),n.displayScreen(e.UnauthPageId)):(n.logAriaEvent(o.d.GenericEvent,"GetOfficeToken_Error",2),n.showErrorPage()),n.clearSavedProvider()})}else this.logAriaEvent(o.d.GenericEvent,"InvalidWamProvider_Error",2)},e.prototype.onAccountCommandsRequested=function(t){var n=this,r=t.getDeferral(),o=new Array;this.requiredMockAuthority?o.push(new Promise(function(t){return Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,n.requiredMockAuthority).then(t)})):(o.push(new Promise(function(t){return Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,e.AadAuthority).then(t)})),o.push(new Promise(function(t){return Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync(e.MsaAadProviderId,e.MsaAuthority).then(t)}))),Promise.all(o).then(function(e){e.forEach(function(e){var r=new Windows.UI.ApplicationSettings.WebAccountProviderCommand(e,function(e){return n.webAccountProviderCommandInvoked(e)});t.webAccountProviderCommands.push(r)}),r.complete()})},e.prototype.showAccountsPane=function(t){var n=this;void 0===t&&(t=!1),this.initializedAccountsPane||(Windows.UI.ApplicationSettings.AccountsSettingsPane.getForCurrentView().onaccountcommandsrequested=function(e){return n.onAccountCommandsRequested(e)},this.initializedAccountsPane=!0);var r=Windows.UI.ApplicationSettings.AccountsSettingsPane;t?r.showManageAccountsAsync?r.showManageAccountsAsync().then(function(){return n.localSettingsProps.remove(e.SwitchAccountKey)}):(this.logAriaEvent(o.d.GenericEvent,"MissingAccountSettingsPaneApi",2),r.show()):r.show()},e.prototype.reloadApp=function(){var t=this;this.flushLogs(!0).then(function(){window.open(""+e.BasePwaPath+t.currentUrl.search,"_self","msHideView=yes",!0)})},e.prototype.bootstrapApp=function(t,n){var r=this;o.d.RevokeStandaloneLogger(),this.logAriaEvent(o.d.GenericEvent,"Pwa_Bootstrap_Start",0);var i=n?void 0:e.InitialPerformanceEvent,a=(n?"Unauth":"Auth")+"_Pwa_Bootstrap_Start";window.measureAppFrom=a,this.markPerformance(a,0,i),this.isConsumer=t,window.pwaCurrentUserId&&o.b.InitDiskPreload(window.pwaCurrentUserId,window.diskPreloadRequestMap,e.DiskPreloadStorageKey);var s=this;return window.shellAndConfigResponse=new Promise(function(e,r){if(s.shellAndConfigPromiseResolver=e,s.shellAndConfigPromiseRejecter=r,!s.isUwp)return window.pwaCurrentUserId="mock user",void s.fetchAndHandleShellAndConfigResponse(t,"mock token");s.getAccountProvider().then(function(e){n?s.fetchAndHandleShellAndConfigResponse(t,n):s.fetchTokenAndCallShellAndConfigApi(e)}).catch(function(){s.shellAndConfigPromiseRejecter("fetch provider error"),s.cleanUpShellAndConfigCallbacks()})}),window.shellAndConfigResponse.then(function(){r.localSettingsProps&&r.localSettingsProps.hasKey(e.SignedOutKey)&&r.localSettingsProps.remove(e.SignedOutKey)},function(){s.showErrorPage()}),this.waitForDocumentLoad().then(function(){var n=r.getReactShellConfig();n.isConsumer=t;var i=n.shellBootHost+(t?n.consumerBootstrapPath:n.commercialBootstrapPath),s=document.createElement("script"),c=document.createElement("script");c.async=s.async=!0,c.crossOrigin=s.crossOrigin="anonymous",c.type=s.type="text/javascript",c.onload=function(){r.markPerformance("Pwa_App_Bundle_Load",0,a)},c.onerror=function(){var t,n=((t={})[e.InstrumentationParamAction]=window.bundleUrl,t);r.logAriaEvent(o.d.GenericEvent,"App_Bundle_Load_Error",0,n)},s.onload=function(){r.markPerformance("Pwa_Shell_Bootstrapper_Load",0,a),r.shellShimReady=!0,r.configRetrieved&&!r.reactShellBootstrapped&&r.bootstrapReactShell(n)},s.onerror=function(){var t,n=((t={})[e.InstrumentationParamAction]=i,t);r.logAriaEvent(o.d.GenericEvent,"Shell_Bootstrapper_Load_Error",0,n)},s.src=i,c.src=window.bundleUrl,window.bundleIntegrity&&(c.integrity=window.bundleIntegrity),document.body.appendChild(c),document.body.appendChild(s)})},e.prototype.bootstrapReactShell=function(t){var n;try{if(this.isConsumer&&(t.isConsumer=!0,this.currentMsaUser&&(t.upn=this.currentMsaUser.upn,t.puid=this.currentMsaUser.puid,t.userDisplayName=this.currentMsaUser.userDisplayName,t.mePhotoSource=this.currentUserPhoto?"data:image/jpeg;base64,"+this.currentUserPhoto:"")),!HomePage.ShellUtil.BootstrapReactShell("OfficePwa",t))throw new Error("Bootstrap failed");this.reactShellBootstrapped=!0,this.isConsumer||HomePage.ShellUtil.HydrateCommercialReactShell(window.navBarData,!0,t)}catch(t){var r="string"==typeof t?t:t.name+": "+t.message,i=((n={})[e.InstrumentationParamError]=r,n);this.logAriaEvent(o.d.GenericEvent,"Shell_Bootstrapper_Error",0,i)}},e.prototype.resetBrowserStorage=function(){sessionStorage.clear(),sessionStorage.setItem(e.ExistingSessionKey,"true"),localStorage.removeItem(e.PwaOnActivatePendingEventArgsKey),this.clearPwaJumpList()},e.prototype.resetSecurityLevel=function(){var e=Windows.System.Profile.PlatformDiagnosticsAndUsageDataSettings.collectionLevel;window.windowsDataSecuritySetting="number"==typeof e?e>=3?3:e:0},e.prototype.onLifecycleEvent=function(e,t,n){(n=n||{}).Type=t.type,n.Target=t.target?t.target.toString():"",this.logAriaEvent(o.d.GenericEvent,"UWPLifecycleEvent_"+e,2,n)},e.prototype.onActivate=function(t){var n=t.detail&&t.detail.length?t.detail[0]:null,r=n.arguments&&n.arguments.toLowerCase().includes("officekey"),i=n.arguments&&n.arguments.toLowerCase().includes("wordpad");if(r)window.requestOriginOverride="OfficeKey";else if(i){window.requestOriginOverride="WordPad";var a=new Date;a.setDate(a.getDate()+14),document.cookie="launchByWordPad=1;expires="+a.toUTCString()+";path=/";var s={by:"WordPad",argument:n.arguments.toLowerCase().includes("open=wordstartpage")?"Word":"Default"};window.localStorage.setItem(e.PwaOnActivatePendingEventArgsKey,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("activated",{detail:s})),this.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventWordPad,2)}if(n.kind===Windows.ApplicationModel.Activation.ActivationKind.launch){this.localSettingsProps.SplashImageWidth=n.splashScreen.imageLocation.width;var c=t;if(c.arguments&&!r&&!i)try{var u=JSON.parse(c.arguments);if(u.createFileType||u.id){var d={};d[e.InstrumentationParamState]="Pending",d[e.InstrumentationParamAction]=u.createFileType?"CreateNewFile":"OpenFile",s={by:"JumpList",argument:c.arguments},window.localStorage.setItem(e.PwaOnActivatePendingEventArgsKey,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("activated",{detail:s})),window.requestOriginOverride="JumpList",this.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpListItemClick,2,d)}}catch(t){var l={};l[e.InstrumentationParamState]="Pending",l[e.InstrumentationParamError]=(t||"").toString(),l[e.InstrumentationParamAction]="ActivateByJumpList",this.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,l)}}n.prelaunchActivated&&(this.setPrelaunchMode(),this.localSettingsProps[e.PrelaunchModeKey]=!0);var p=n?{Kind:Windows.ApplicationModel.Activation.ActivationKind[n.kind],PreviousState:Windows.ApplicationModel.Activation.ApplicationExecutionState[n.previousExecutionState],TileId:n.tileId,ViewId:n.currentlyShownApplicationViewId.toString(),FromOfficeKey:r}:{};this.onLifecycleEvent("Activate",t,p),!n.prelaunchActivated&&Windows.UI.WebUI.WebUIApplication.hasOwnProperty("enablePrelaunch")&&"function"==typeof Windows.UI.WebUI.WebUIApplication.enablePrelaunch&&Windows.UI.WebUI.WebUIApplication.enablePrelaunch(!0)},e.prototype.onSuspend=function(e){this.onLifecycleEvent("Suspend",e)},e.prototype.onResume=function(e){window.pwaResuming=!0,this.onLifecycleEvent("Resume",e)},e.prototype.onNavigate=function(e){this.onLifecycleEvent("Navigate",e)},e.prototype.onEnterBackground=function(e){this.onLifecycleEvent("EnterBackground",e)},e.prototype.onLeaveBackground=function(e){this.onLifecycleEvent("LeaveBackground",e)},e.prototype.isConsumerAuthority=function(t){return t===e.MsaAuthority},e.prototype.installThirdPartyNotice=function(){var t=this,n=Windows.Storage.ApplicationData.current.localFolder;fetch(window.thirdPartyNoticeUrl).then(function(r){if(!r.ok)throw new Error;return r.arrayBuffer().then(function(r){var o=Windows.Security.Cryptography.CryptographicBuffer.createFromByteArray(Array.from(new Uint8Array(r)));return n.createFileAsync(e.ThirdPartyNoticeFileName,Windows.Storage.CreationCollisionOption.replaceExisting).then(function(e){return t.thirdPartyLicenseNotice=e,Windows.Storage.FileIO.writeBufferAsync(e,o)})})}).catch(function(){return t.logAriaEvent(o.d.GenericEvent,"InstallThirdPartyNotice_Error",2),n.getFileAsync(e.ThirdPartyNoticeFileName).then(function(e){t.thirdPartyLicenseNotice=e})}).catch(function(){t.logAriaEvent(o.d.GenericEvent,"GetThirdPartyNotice_Error",2)})},e.prototype.forceNewServiceWorker=function(){var t=this;return this.swEnabled?new Promise(function(n){navigator.serviceWorker.getRegistration(e.BasePwaPath).then(function(e){if(e){var r=e.waiting;if(r){var i=!1,a=new Promise(function(e){navigator.serviceWorker.oncontrollerchange=function(){i=!0,e()}}),s=new Promise(function(e){setTimeout(e,500)});return r.postMessage({type:"OFFICECOM_FORCE_ACTIVATION"}),void Promise.race([a,s]).then(function(){i||t.logAriaEvent(o.d.GenericEvent,"SWForceActivation_Error",0),n()})}if(e.active){var c=function(){return e.unregister().then(function(e){return n()}).catch(function(e){return n()})};return void caches.keys().then(function(e){e&&e.some(function(e){return e.indexOf(window.pwaCurrentUserId)>=0&&e.indexOf("shell-config-api")>=0})?n():c()},c)}}n()})}):Promise.resolve()},e.prototype.displayScreen=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t&&t.length&&(t.includes(e.OfficeHomeId)&&(document.getElementById(e.ReactShellHeaderId).style.display="block"),this.elementsDisplayStyleMap.forEach(function(e,n){var r=document.getElementById(n);r&&(t.includes(n)?r.style.display=e:r.style.display="none")}))},e.prototype.showErrorPage=function(){var t=this,n=function(){t.logAriaEvent(o.d.GenericEvent,"Pwa_Error_PageView",0),t.waitForPageLoad().then(function(){t.flushLogs(),document.getElementById("correlation-id").innerText=window.overrideCID,t.displayScreen(e.ErrorPageId),t.markPerformance("Pwa_Error_Ready",0)})};this.swEnabled?navigator.serviceWorker.getRegistration(e.BasePwaPath).then(function(e){return e&&e.active?(t.logAriaEvent(o.d.GenericEvent,"Pwa_FoundErrorWithSW",0),e.unregister().then(function(e){return e?Promise.resolve(e):Promise.reject()})):(n(),Promise.resolve(!1))}).then(function(e){e&&(t.logAriaEvent(o.d.GenericEvent,"Pwa_WorkerUnregistration_Success",0),t.reloadApp())}).catch(function(){t.logAriaEvent(o.d.GenericEvent,"Pwa_WorkerUnregistration_Failed",0),n()}):n()},e.prototype.setPrelaunchMode=function(){window.prelaunchMode=!0,Math.random()>e.PrelaunchLogsSamplingRate&&(window.disableLogs=!0);var t=this,n=function(){window.prelaunchMode&&(window.prelaunchMode=!1,window.disableLogs=!1,t.localSettingsProps.remove(e.PrelaunchModeKey),t.logAriaEvent(o.d.GenericEvent,"Pwa_FocusWindow_PageView",0)),window.removeEventListener("focus",n)};window.addEventListener("focus",n)},e.prototype.getAriaContext=function(){var e=this;return this.getSharedClientStartupConfig().then(function(t){if(!t)return Promise.reject("Startup config not found");var n=e.isUwp?Windows.ApplicationModel.Package.current.id.version:null;return Promise.resolve({ariaCollectorUrl:t.ariaCollectorUrl,ariaTenant:t.ariaTenant,authTypeString:e.currentAccountProvider?e.currentAccountProvider.authority:"",cookieConsentRequired:t.cookieConsentRequired,corpNet:t.corpNet,correlationId:window.overrideCID,deploymentEnvironment:t.deploymentEnvironment,devEnvironment:t.devEnvironment,features:"",flights:t.flights,geoName:t.geoName,puid:"",requestOrigin:window.requestOriginOverride||t.requestOrigin,serverBuildDate:t.buildDateUtc,serverBuildId:t.buildId,sessionId:window.overrideSID,tenantId:"",testTraffic:t.testTraffic,wrapperVersion:n&&n.major+"."+n.minor+"."+n.build+"."+n.revision})})},e.prototype.flushLogs=function(t){return void 0===t&&(t=!1),o.d.FlushQueuedEvents(this.getAriaContext(),t,e.PwaPage)},e.prototype.parseJsonElementWithId=function(e){var t=document.getElementById(e);return t&&t.textContent?JSON.parse(t.textContent):null},e.prototype.getSharedClientStartupConfig=function(){var e=this;return this.waitForDocumentLoad().then(function(){return e.parseJsonElementWithId("sharedClientStartupConfigJson")})},e.prototype.waitForPageLoad=function(){return new Promise(function(e){"complete"===document.readyState?e():window.addEventListener("load",function(){e()})})},e.prototype.waitForDocumentLoad=function(){return new Promise(function(e){"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",function(){e()})})},e.prototype.clearPwaJumpList=function(){var t=this;localStorage.removeItem(e.PwaJumpListMappingKey),localStorage.removeItem(e.PwaJumpListRemovedItemsKey);var n={};Windows.UI.StartScreen.JumpList.loadCurrentAsync().then(function(r){r.systemGroupKind=Windows.UI.StartScreen.JumpListSystemGroupKind.none,r.items.clear(),r.saveAsync().then(function(){n[e.InstrumentationParamState]="Success",n[e.InstrumentationParamAction]="SaveJumpListToClear",t.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,n)},function(r){n[e.InstrumentationParamError]=(r||"").toString(),n[e.InstrumentationParamAction]="SaveJumpListToClear",t.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,n)})},function(r){n[e.InstrumentationParamError]=(r||"").toString(),n[e.InstrumentationParamAction]="LoadJumpListToClear",t.logAriaEvent(o.d.GenericEvent,e.InstrumentationEventJumpList,2,n)})},e.prototype.setupCurrentUser=function(e,t){window.pwaCurrentUserId=this.getUserIdKey(e,t),this.getCurrentUserPhoto()},e.prototype.setupPreboot=function(){var e=this,t=function(t,n){return e.logPrebootClick(t,n)},n=this.generatePrebootClickForParentSelector(".tiles__container ohp-app-tile a",t,["click"],!0,!0,!0),o=this.generatePrebootClickForParentSelector("#create-menu-dropdown-link",t,["click"],!0,!0,!0),i=this.generatePrebootClickForParentSelector("#explore-your-apps",t,["click"],!0,!0,!0),a=this.generatePrebootClickForParentSelector("#install-dropdown-link",t,["click"],!0,!0,!0),s=this.generatePrebootClickForParentSelector("#see-more-items-unpinned-mru",t,["click"],!0,!0,!0),c=Object(r.a)("#attribution-unpinned-mru",t,!1,["click"],!1,!1),u=Object(r.a)("#attribution-unpinned-mru *",t,!1,["click"],!1,!1),d=this.generatePrebootClickForParentSelector("#tab-list-header-link-trending-docs",t,["click"],!0,!0,!0),l=this.generatePrebootClickForParentSelector("#tab-list-header-link-shared-mru",t,["click"],!0,!0,!0),p=this.generatePrebootClickForParentSelector("#tab-list-header-link-pinned-mru",t,["click"],!0,!0,!0),h=this.generatePrebootClickForParentSelector("#recommended-nav-right",t,["click"],!0,!0,!0),f=[];[n,o,i,a,s,c,u,d,l,p,h,[{selector:"*",events:["focusin"],replay:!1},{selector:"*",events:["focusout"],replay:!1}]].forEach(function(e){e instanceof Array?e.forEach(function(e){f.push(e)}):f.push(e)}),Object(r.b)(function(){return document.getElementById("ohp-pwa-view-cache")},function(){return document.getElementsByTagName("ohp-pwa-root")[0]},f)},e.prototype.generatePrebootClickForParentSelector=function(e,t,n,o,i,a){var s=this;return[Object(r.a)(e,t,o,n,i,a),Object(r.a)(e+" *",function(t){return s.clickParentMatchingSelector(e,t)},!1,n,!1,a)]},e.prototype.clickParentMatchingSelector=function(e,t){for(var n=t;!n.matches(e);)if(!(n=n.parentElement))return;n.click()},e.prototype.logPrebootClick=function(e,t){},e.prototype.setupRemoveSplashScreenListener=function(){var t=this;this.waitForDocumentLoad().then(function(){var n=document.getElementById(e.ViewCacheId);n&&n.childElementCount>0&&t.displayScreen(e.OfficeHomeId,e.ViewCacheId)})},e.AadAuthority="organizations",e.BasePwaPath="/pwa",e.CurrentAccountIdKey="CurrentAccountId",e.CurrentAuthorityKey="CurrentAuthority",e.CurrentUserProviderIdKey="CurrentUserProviderId",e.DiskPreloadStorageKey="PwaDiskPreloadUrlCache",e.ErrorPageId="error-page",e.ExistingSessionKey="ExistingSession",e.ExtendedSplashScreenId="extended-splash-screen",e.InitialPerformanceEvent="Pwa_Init",e.InstrumentationEventJumpList="Pwa_Jump_List",e.InstrumentationEventJumpListItemClick="Pwa_Jump_List_Item_Click",e.InstrumentationEventWordPad="Pwa_Activated_By_Word_Pad",e.InstrumentationParamAction="Action",e.InstrumentationParamError="Error",e.InstrumentationParamState="State",e.LocalProviderId="https://login.windows.local",e.PrelaunchLogsSamplingRate=.005,e.PwaPage="Pwa",e.MsaAadProviderId="https://login.microsoft.com",e.MsaAuthority="consumers",e.OfficeApiResource="OfficeApi",e.OfficeHomeId="officeHome",e.PrelaunchModeKey="PrelaunchMode",e.PwaJumpListMappingKey="PwaJumpListMapping",e.PwaJumpListRemovedItemsKey="PwaJumpListRemovedItems",e.PwaOnActivatePendingEventArgsKey="PwaOnActivatePendingEventArgs",e.ReactShellHeaderId="ReactShellHeader",e.ShellConfigElementId="reactShellConfiguration",e.SignedOutKey="UserSignedOut",e.SignOutWindowName="logout",e.SignOutWindowNameKey="LogoutWindowName",e.SwitchAccountKey="SwitchAccount",e.ThirdPartyNoticeFileName="ThirdPartyNotice.html",e.ToastMessageKey="{TOASTMSG}",e.UnauthPageId="unauth-page",e.ViewCacheId="ohp-pwa-view-cache",e}());i.canRender()||(window.location.href="/"),i.initializeGlobalFunctions(),i.initVars(),i.initApp()},swXz:function(e,t,n){"use strict";function r(e){for(var t=[],n=e.root,r=e.node,o=r;o&&o!==n.serverNode&&o!==n.clientNode;)t.push(o),o=o.parentNode;o&&t.push(o);for(var i=r.nodeName||"unknown",a=t.length-1;a>=0;a--)if((o=t[a]).childNodes&&a>0)for(var s=0;s<o.childNodes.length;s++)if(o.childNodes[s]===t[a-1]){i+="_s"+(s+1);break}return i}function o(e){var t=e.createElement("div");return t.setAttribute("id","prebootOverlay"),t.setAttribute("style","display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:999999;background:black;opacity:.3"),e.documentElement.appendChild(t),t}function i(e,t,n,o){var i=n.root.serverNode;i&&o.events.forEach(function(s){var c=function(e,t,n,o){var i=["keyup","keydown","focusin","mouseup","mousedown"],s=["INPUT","TEXTAREA"],c=e.documentElement.matches||e.documentElement.msMatchesSelector,u=t.opts;return function(e){var d=e.target;if(c.call(d,n.selector)){var l=o.root,p=e.type;if(d&&p){var h=n.keyCodes;if(h&&h.length&&!h.filter(function(t){return e.which===t}).length)return;n.preventDefault&&e.preventDefault(),n.action&&n.action(d,e);var f=r({root:l,node:d});if(i.indexOf(p)>=0){var g=s.indexOf(d.tagName?d.tagName:"")>=0;t.activeNode={root:l,node:d,nodeKey:f,selection:g?a(d):void 0}}else"change"!==p&&"focusout"!==p&&(t.activeNode=void 0);if(u&&!u.disableOverlay&&n.freeze){var v=l.overlay;v.style.display="block",setTimeout(function(){v.style.display="none"},1e4)}n.replay&&o.events.push({node:d,nodeKey:f,event:e,name:p})}}}}(e,t,o,n);i.addEventListener(s,c,!0),t.listeners&&t.listeners.push({node:i,eventName:s,handler:c})})}function a(e){var t=(e=e||{}).value||"",n={start:t.length,end:t.length,direction:"forward"};try{(e.selectionStart||0===e.selectionStart)&&(n.start=e.selectionStart,n.end=e.selectionEnd?e.selectionEnd:0,n.direction=e.selectionDirection?e.selectionDirection:"none")}catch(e){}return n}n.d(t,"a",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s}),function(){function e(){this.clientNodeCache={},this.replayStarted=!1}e.prototype.setWindow=function(e){this.win=e},e.prototype.getWindow=function(){return this.win||(this.win={prebootData:window.prebootData,getComputedStyle:window.getComputedStyle,document:document}),this.win},e.prototype.replayAll=function(){var e=this;if(!this.replayStarted){this.replayStarted=!0;var t=this.getWindow().prebootData||{};(t.apps||[]).forEach(function(t){return e.replayForApp(t)}),this.cleanup(t)}},e.prototype.replayForApp=function(e){var t=this;e=e||{};try{(e.events||[]).forEach(function(n){return t.replayEvent(e,n)})}catch(e){console.error(e)}this.switchBuffer(e)},e.prototype.replayEvent=function(e,t){e=e||{};var n=(t=t||{}).event,r=t.node||{},o=t.nodeKey,i=this.findClientNode({root:e.root,node:r,nodeKey:o});i?(i.checked=r.checked,i.selected=r.selected,i.value=r.value,i.dispatchEvent(n)):console.warn("Trying to dispatch event "+n.type+" to node "+o+"\n        but could not find client node. Server node is: "+r)},e.prototype.switchBuffer=function(e){var t=(e=e||{}).root||{},n=t.serverNode,r=t.clientNode;if(r&&n&&n!==r&&"BODY"!==n.nodeName)try{var o=(0,this.getWindow().getComputedStyle)(n).getPropertyValue("display")||"block";n.remove?n.remove():n.style.display="none",r.style.display=o}catch(e){console.error(e)}},e.prototype.cleanup=function(e){var t=this,n=(e=e||{}).listeners||[],r=e.activeNode;null!=r&&setTimeout(function(){return t.setFocus(r)},1);for(var o=0,i=n;o<i.length;o++){var a=i[o];a.node.removeEventListener(a.eventName,a.handler)}var s=this.getWindow().document,c=s.getElementById("prebootOverlay");if(c&&(c.remove?c.remove():null!==c.parentNode?c.parentNode.removeChild(c):c.style.display="none"),e.apps=[],this.clientNodeCache={},"function"==typeof CustomEvent){var u=new CustomEvent("PrebootComplete");s.dispatchEvent(u)}else console.warn("Could not dispatch PrebootComplete event.\n       You can fix this by including a polyfill for CustomEvent.")},e.prototype.setFocus=function(e){if(e&&e.node&&e.nodeKey){var t=this.findClientNode(e);if(t){t.focus();var n=e.selection;if(t.setSelectionRange&&n)try{t.setSelectionRange(n.start,n.end,n.direction)}catch(e){}}}},e.prototype.findClientNode=function(e){var t=(e=e||{}).node,n=e.root;if(!n||!n.serverNode||!n.clientNode)return null;var o=e.nodeKey||r(e);if(this.clientNodeCache[o])return this.clientNodeCache[o];var i=(t.className||"").replace("ng-binding","").trim(),a=t.tagName;t.id?a+="#"+t.id:i&&(a+="."+i.replace(/ /g,"."));var s=n.clientNode,c=s.querySelectorAll(a);c.length||(console.log("nothing found for "+a+" so using "+t.tagName),c=s.querySelectorAll(t.tagName));for(var u=c.length,d=0;d<u;d++){var l=c.item(d);if(r({root:n,node:l})===o)return this.clientNodeCache[o]=l,l}return 1===c.length?(this.clientNodeCache[o]=c[0],c[0]):(console.warn("No matching client node found for "+o+".\n       You can fix this by assigning this element a unique id attribute."),null)}}();var s={buffer:!0,replay:!0,disableOverlay:!1,eventSelectors:[{selector:"input,textarea",events:["keypress","keyup","keydown","input","change"]},{selector:"select,option",events:["change"]},{selector:"input",events:["keyup"],preventDefault:!0,keyCodes:[13],freeze:!0},{selector:"form",events:["submit"],preventDefault:!0,freeze:!0},{selector:"input,textarea",events:["focusin","focusout","mousedown","mouseup"],replay:!1},{selector:"button",events:["click"],preventDefault:!0,freeze:!0}]};Array.isArray,Error.prototype,"function"==typeof Symbol&&Symbol.observable,Error.prototype,Error.prototype,Error.prototype},yxA9:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return s});var r=36e5,o=function(){function e(){}return e.GetCookies=function(){return document.cookie.split("; ").map(function(e){return e.split("=")}).map(function(e){var t=e[0],n=e[1];return{key:decodeURIComponent(t),value:decodeURIComponent(n)}})},e.CreateGuid=function(){var e=window.performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},e.InitializeCIDSID=function(t,n){if(t){var r=e.GetQueryParam(new URL(window.location.href),"cid");window.overrideCID=r||e.CreateGuid();var o=e.GetCookies().find(function(e){return e.key===t});if(o)window.overrideSID=o.value;else{window.overrideSID=e.CreateGuid();var i=n?";path="+n:"";document.cookie=t+"="+encodeURIComponent(window.overrideSID)+i}}},e.NotifyInstallingWorkerAppFailed=function(e,t){if(void 0===t&&(t=!1),e){var n=function(){var r={type:"OFFICECOM_LOAD_COMPLETE",meta:"installation-app",payload:{success:!1,unregister:t}};e.installing.postMessage(r),e.removeEventListener("updatefound",n)};e.installing?n():(e.addEventListener("updatefound",n),setTimeout(function(){e.removeEventListener("updatefound",n)},5e3))}},e.SetQueryParam=function(e,t,n){if(e&&t&&n)if("undefined"==typeof URLSearchParams){var r=e.search;if(!r||r.length<2)e.search="?"+t+"="+n;else{var o,i=r.substring(1).split("&");for(o=0;o<i.length;o++){var a=i[o].split("=")[0];if(a===t){i[o]=a+"="+n;break}}o===i.length&&i.push(t+"="+n),e.search="?"+i.join("&")}}else e.searchParams.set(t,n)},e.GetQueryParam=function(e,t){if(!e||!t)return"";if("undefined"!=typeof URLSearchParams)return e.searchParams.get(t);var n=e.search;if(!n||n.length<2)return"";for(var r=n.substring(1).split("&"),o=0;o<r.length;o++){var i=r[o].split("="),a=i[0],s=i[1];if(a===t)return s}return""},e.getTokenPayload=function(t){if(!t)return null;var n=t.split(".");if(3!==n.length)return null;var r=n[1];try{return JSON.parse(e.base64UrlDecode(r))}catch(e){return null}},e.base64UrlDecode=function(e){var t=e.length%4;if(2===t)e+="==";else if(3===t)e+="=";else if(1===t)return null;return e=e.replace("_","/").replace("-","+"),window.atob(e)},e}(),i=function(){function e(){}return e.CurrentTime=function(){return e.PerformanceLoggingEnabled?performance.now():(new Date).getTime()},e.LogEvent=function(t,n,r,o,i){if(o=o||{},i=i||[],window.instrumentationService)window.instrumentationService.generateEvent(n,t,r,o,i,!0);else if(e.StandaloneLoggerRunning)StandaloneAriaLogger.Logger.LogEvent(t,n,o,r);else{window.queuedEvents||(window.queuedEvents=[]);var a={streamName:t,eventName:n,eventParams:o,metrics:i,securityThreshold:r};window.queuedEvents.push(a)}},e.MarkPerformance=function(t,n,r,o,i){if(e.PerformanceLoggingEnabled&&!(r>o)&&t)if(window.performanceService)window.performanceService.mark(t,n,0);else{window.performance.mark(t),window.queuedMarks||(window.queuedMarks=[]);var a={markName:t,measureFrom:n,eventParams:i};window.queuedMarks.push(a),e.DrainOnMark&&e.GeneratePerformanceEvents(!1)}},e.FlushQueuedEvents=function(t,n,r){return e.GeneratePerformanceEvents(n,r),window.instrumentationService||e.StandaloneLoggerRunning?(n&&(window.instrumentationService?window.instrumentationService.flush():StandaloneAriaLogger.Logger.EndSession(!0,!0)),Promise.resolve(!0)):t.then(function(t){return"undefined"!=typeof StandaloneAriaLogger&&StandaloneAriaLogger.Logger?(StandaloneAriaLogger.Logger.Initialize(t,!1),n&&StandaloneAriaLogger.Logger.EndSession(!0,!0),e.StandaloneLoggerRunning=!0,Promise.resolve(!0)):Promise.reject("Standalone aria logger does not exist")}).catch(function(e){return console.log(e),Promise.resolve(!1)})},e.RevokeStandaloneLogger=function(){e.StandaloneLoggerRunning&&(StandaloneAriaLogger.Logger.EndSession(!0,!1),e.StandaloneLoggerRunning=!1,e.DrainOnMark=!1)},e.GeneratePerformanceEvents=function(t,n){if(e.DrainOnMark=!0,e.PerformanceLoggingEnabled&&!window.performanceService){var r=function(t,n,r){(r=r||{}).Latency=n.toString(),r.ItemCategory="Inline",e.LogEvent(e.PerformanceDump,t,0,r,[])},o=function(t,n,r){(r=r||{}).Error=t,r.DebugInfo=n,r.ItemCategory="Inline",e.LogEvent(e.GenericEvent,e.PerformanceMarkFailure,0,r,[])};window.queuedMarks&&window.queuedMarks.splice(0,window.queuedMarks.length).forEach(function(e){var t=e.measureFrom||"navigationStart";try{window.performance.measure(e.markName,t,e.markName)}catch(n){return void o(e.markName,"Failed to record <"+e.markName+"> starting from <"+t+">: exception is thrown",e.eventParams)}var n=window.performance.getEntriesByName(e.markName,"measure");if(n&&n.length){var i=n[0],a=Math.ceil(i.duration);r(e.markName,a,e.eventParams)}else o(e.markName,"Failed to record <"+e.markName+">: measure missing",e.eventParams)}),t||"complete"===document.readyState?e.BrowserMeasuresLogged||(e.BrowserMeasuresLogged=!0,e.GetBrowserTimingMeasures(function(e,t){o(e,t,{Page:n})}).forEach(function(e){r(e.name,e.duration,{Page:n})})):window.addEventListener("load",function(){e.GeneratePerformanceEvents(!0,n)})}},e.PerformanceLoggingSupported=function(){var e=window.performance;return!!(e&&e.now&&e.mark&&e.timing&&e.timing.navigationStart&&e.measure&&e.getEntriesByType)},e.GetBrowserTimingMeasures=function(t,n,r){var o=new Array;if(!e.PerformanceLoggingSupported())return o;for(var i in window.performance.timing){var a=e.globalWhitelistedMarkers.get(i);if(a){var s=window.performance.timing[i],c=window.performance.timing[a];if("number"==typeof s&&"number"==typeof c)if(0!==s&&0!==c)if(s<c)t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to relative marker value being greater than marker value: <"+i+">="+s+"; diff from <"+a+">="+(s-c));else if(s<window.performance.timing.navigationStart)t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to marker value being less than <navigationStart> marker value: <"+i+">="+s+"; diff from <navigationStart}>="+(s-window.performance.timing.navigationStart));else if(c<window.performance.timing.navigationStart)t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to relative marker value being less than <navigationStart> marker value: <"+i+">="+s+"; <"+a+">="+c+"; diff from <navigationStart}>="+(c-window.performance.timing.navigationStart));else{var u=Math.ceil(s-c);o.push({name:i,duration:u,params:n?Object.assign({},n):{}});var d=i+"_ohp_measure";r&&r(i,d);try{window.performance.measure(d,a,i)}catch(e){t(i,"Failed to record measure for <"+i+"> starting from <"+a+">: exception is thrown")}}else"unloadEventStart"!==i&&"unloadEventEnd"!==i&&t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to unexpected zero values: <"+i+">="+s+"; <"+a+">="+c);else t(i,"Failed to calculate measure for <"+i+"> starting from <"+a+"> due to unexpected value type: <"+i+"> value type is "+typeof s+"; <"+a+"> value type is "+typeof c)}}return o},e.PerformanceLoggingEnabled=e.PerformanceLoggingSupported(),e.DrainOnMark=!1,e.BrowserMeasuresLogged=!1,e.StandaloneLoggerRunning=!1,e.GenericClick="Generic_Click",e.GenericEvent="Generic_Event",e.GenericRequest="Generic_Request",e.PerformanceDump="Performance_Dump",e.PerformanceMarkFailure="Performance_Mark_Failure",e.globalWhitelistedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e}(),a=function(){function e(){}return e.InitDiskPreload=function(e,t,n){var r=window.navigator.serviceWorker&&window.navigator.serviceWorker.controller;if(e&&r&&t){var o=[],a=localStorage.getItem(n);a&&(o=JSON.parse(a)),o.forEach(function(n){var r=n.url,o=n.markerName;if(r&&o){var a=new Headers;a.append("X-SW-OHP-FetchStrategy","cache-only"),a.append("X-SW-OHP-UserCacheId",e);var s=new Request(r,{headers:a}),c="Disk_Preload_Start_"+o;i.MarkPerformance(c,"",0,3);var u=fetch(s).catch(function(){return Response.error()});u.then(function(){var e="Disk_Preload_End_"+o;i.MarkPerformance(e,c,0,3)}),t.set(r,u)}})}},e}(),s=function(){function e(){}return e.prefetchMruData=function(e,t,n,r,o,i){var a=new URL(window.location.href),s=t?a.origin+"/mock/v2/recent/docs":"https://ocws.officeapps.live.com/ocs/v2/recent/docs",c=new URL(s+"?apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,Project,Portfolio,Forms,PdfViewer&show=100&rs="+n),u=new Headers;u.append("Content-Type","application/json"),u.append("X-CorrelationId",window.overrideCID),u.append("X-Office-Platform","Web"),u.append("X-Office-Application",109..toString()),u.append("X-Office-Version",r),e&&u.append("Authorization","Bearer "+e.token),o&&this.addCacheHeaders(u,o),i&&u.append("ohp-mock",i);var d={method:"GET",headers:u,cache:"default",credentials:"include"},l=new Request(c.toString(),d);return fetch(l)},e.prefetchRecommendedData=function(e,t,n,r,a,s,c){var u,d=new URL(window.location.href),l=t?d.origin+"/mock/recommended/api/v1.0":"https://substrate.office.com/recommended/api/v1.0",p=new URL(l+"/files?show=16&skipCache=false&apps=Word,Excel,PowerPoint,OneNote,Pdf,Visio&rs="+n),h=new Headers;if(h.append("client-request-id",c),h.append("X-Office-Application",114..toString()),h.append("X-Ms-ClientAppId",r),e){h.append("Authorization","Bearer "+e.token);try{u=o.getTokenPayload(e.token)}catch(e){var f=window.getCommonParamsAntp();f.Error=e,i.LogEvent(i.GenericEvent,"JwtToken_Decode_Error",0,f,[])}u&&u.oid&&u.tid&&(h.append("X-AnchorMailbox",u.oid+"@"+u.tid),h.append("X-RoutingParameter-SessionKey",u.oid))}a&&this.addCacheHeaders(h,a),s&&h.append("ohp-mock",s);var g={method:"GET",headers:h,cache:"default",credentials:"include"},v=new Request(p.toString(),g);return fetch(v)},e.prefetchSharePointSitesData=function(e,t,n,r,o,i){var a=new URL(window.location.href),s=t?a.origin+"/mock/sites":"https://odc.officeapps.live.com/odc/servicemanager/v2.0/sites?lcid="+n+"&uilcid="+n+"&syslcid="+n+"&lists=frequent,followed&items=12",c=new URL(s),u=new Headers;u.append("Accept","application/json"),u.append("X-CorrelationId",window.overrideCID),u.append("X-Office-Platform","Web"),u.append("X-Office-Application",109..toString()),u.append("X-Office-Version",r),e&&u.append("Authorization","Bearer "+e.token),o&&this.addCacheHeaders(u,o),i&&u.append("ohp-mock",i);var d={method:"GET",headers:u,cache:"default"},l=new Request(c.toString(),d);return fetch(l)},e.addCacheHeaders=function(e,t){if("serviceWorker"in window.navigator){var n=!!window.navigator.serviceWorker.controller,r=window.navigator.onLine;n&&r&&t&&(e.append("X-SW-OHP-FetchStrategy","network-first"),e.append("X-SW-OHP-UserCacheId",t))}},e}()}});
//# sourceMappingURL=pwa-bootstrap-cc0e5e328925d00ac1c2.js.map